{"version":3,"sources":["../src/animator/animator.ts","../src/animator/index.ts","../src/app.ts","../src/app.html","../src/board/board.ts","../src/board/board.html","../src/board/fortress.ts","../src/board/fortress.html","../src/board/game-over.ts","../src/board/game-over.html","../src/board/index.ts","../src/board/tile.ts","../src/board/tile.html","../src/board/tragedy.ts","../src/board/tragedy.html","../src/buildings/construction-panel.ts","../src/buildings/construction-panel.html","../src/buildings/fortress-building.ts","../src/buildings/fortress-building.html","../src/buildings/index.ts","../src/buildings/purchase-panel.ts","../src/buildings/purchase-panel.html","../src/buildings/tile-building.ts","../src/buildings/tile-building.html","../src/environment.ts","../src/main.ts","../src/main.scss","../style/_colors.scss","../src/_app.scss","../style/_helpers.scss","../src/_start-screen.scss","../src/board/_tile.scss","../src/board/_board.scss","../src/board/_tragedy.scss","../src/board/_fortress.scss","../src/board/_game-over.scss","../src/player/_player.scss","../src/sidebar/_index.scss","../src/sidebar/_dice.scss","../src/sidebar/_tragedy-overview.scss","../src/sidebar/_resources-overview.scss","../src/sidebar/_stats-overview.scss","../src/sidebar/_build-overview.scss","../src/buildings/_purchase-panel.scss","../src/buildings/_tile-building.scss","../src/buildings/_construction-panel.scss","../src/buildings/_fortress-building.scss","../src/monster/_index.scss","../src/monster/index.ts","../src/monster/monster.ts","../src/monster/monster.html","../src/player/index.ts","../src/player/player.ts","../src/player/player.html","../src/resources/index.ts","../src/sidebar/build-overview.ts","../src/sidebar/build-overview.html","../src/sidebar/dice.ts","../src/sidebar/dice.html","../src/sidebar/index.ts","../src/sidebar/resources-overview.ts","../src/sidebar/resources-overview.html","../src/sidebar/save.ts","../src/sidebar/save.html","../src/sidebar/sidebar.ts","../src/sidebar/sidebar.html","../src/sidebar/stats-overview.ts","../src/sidebar/stats-overview.html","../src/sidebar/tragedy-overview.ts","../src/sidebar/tragedy-overview.html","../src/start-screen.ts","../src/start-screen.html","../src/store/actions/commands.ts","../src/store/actions/dice-roll.ts","../src/store/actions/monsters.ts","../src/store/actions/tragedy-events.ts","../src/store/helper.ts","../src/store/index.ts","../src/store/state.ts","../src/utils/generic-dialog.html","../src/utils/utils.ts"],"names":[],"mappings":"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","file":"app-bundle.js","sourcesContent":["import { Animator } from \"aurelia-templating\";\n\ninterface CssAnimation {\n  className: string;\n  element: Element;\n}\n\n/**\n * An implementation of the Animator using CSS3-Animations.\n */\nexport class WebAnimationAnimator extends Animator {\n  public isAnimating: boolean = false;\n\n  public storedEnterAnimations: { [selector: string]: {\n    keyframes: Keyframe[] | PropertyIndexedKeyframes | null | any,\n    options?: number | KeyframeAnimationOptions\n  }} = {};\n  public storedLeaveAnimations: { [selector: string]: {\n    keyframes: Keyframe[] | PropertyIndexedKeyframes | null | any,\n    options?: number | KeyframeAnimationOptions\n  }} = {};\n\n  /**\n   * Execute a single animation.\n   * @param element Element to animate\n   * @param className Properties to animate or name of the effect to use.\n   *  For css animators this represents the className to be added and removed right after the animation is done.\n   * @param options options for the animation (duration, easing, ...)\n   * @returns Resolved when the animation is done\n   */\n  public animate(\n    element: Element | Element[],\n    keyframes: Keyframe[] | PropertyIndexedKeyframes | null | any,\n    options?: number | KeyframeAnimationOptions\n  ): Promise<boolean> {\n    const animation = (element as HTMLElement).animate(keyframes, options as any);\n    return animation.finished.then(() => true);\n  }\n\n  /**\n   * Run a sequence of animations one after the other.\n   * @param sequence An array of effectNames or classNames\n   * @returns Resolved when all animations are done\n   */\n  public runSequence(animations: CssAnimation[]): Promise<boolean> {\n    return Promise.resolve(false);\n  }\n\n  /**\n   * Execute an 'enter' animation on an element\n   * @param element Element to animate\n   * @returns Resolved when the animation is done\n   */\n  public enter(element: Element): Promise<boolean> {\n    const settings = Object.assign({\n      keyframes: { opacity: [0, 1]},\n      options: 2000\n    }, this.storedEnterAnimations[element.tagName]);\n    const animation = (element as HTMLElement).animate(settings.keyframes, settings.options);\n    return animation.finished.then(() => true);\n  }\n\n  /**\n   * Execute a 'leave' animation on an element\n   * @param element Element to animate\n   * @returns Resolved when the animation is done\n   */\n  public leave(element: Element): Promise<boolean> {\n    const settings = Object.assign({\n      keyframes: { opacity: [0, 1]},\n      options: 2000\n    }, this.storedLeaveAnimations[element.tagName]);\n    const animation = (element as HTMLElement).animate(settings.keyframes, settings.options);\n    return animation.finished.then(() => true);\n  }\n\n  /**\n   * Add a class to an element to trigger an animation.\n   * @param element Element to animate\n   * @param className Properties to animate or name of the effect to use\n   * @param suppressEvents Indicates whether or not to suppress animation events.\n   * @returns Resolved when the animation is done\n   */\n  public removeClass(element: Element, className: string, suppressEvents: boolean = false): Promise<boolean> {\n    return Promise.resolve(false);\n  }\n\n  /**\n   * Add a class to an element to trigger an animation.\n   * @param element Element to animate\n   * @param className Properties to animate or name of the effect to use\n   * @param suppressEvents Indicates whether or not to suppress animation events.\n   * @returns Resolved when the animation is done\n   */\n  public addClass(element: Element, className: string, suppressEvents: boolean = false): Promise<boolean> {\n    return Promise.resolve(false);\n  }\n}\n\n// only polyfill .finished in browsers that already support animate()\nif (document.body.animate) {\n\n  // Chrome does not seem to expose the Animation constructor globally\n  if (typeof Animation === \"undefined\") {\n    window.Animation = (document.body.animate as any)({}).constructor;\n  }\n\n  if (Animation.prototype.finished === undefined) {\n    Object.defineProperty(Animation.prototype, \"finished\", {\n      get() {\n        if (!this._finished) {\n          this._finished = this.playState === \"finished\" ?\n            Promise.resolve() :\n            new Promise((resolve, reject) => {\n              this.addEventListener(\"finish\", resolve, {once: true});\n              this.addEventListener(\"cancel\", reject, {once: true});\n            });\n        }\n        return this._finished;\n      }\n    });\n  }\n}\n","import { FrameworkConfiguration } from \"aurelia-framework\";\nimport { TemplatingEngine } from \"aurelia-templating\";\n\nimport { WebAnimationAnimator } from \"./animator\";\n\n/**\n * Configuires the WebAnimationAnimator as the default animator for Aurelia.\n * @param config The FrameworkConfiguration instance.\n * @param callback A configuration callback provided by the plugin consumer.\n */\nexport function configure(config: FrameworkConfiguration, callback?: (animator: WebAnimationAnimator) => void): void {\n  const animator = config.container.get(WebAnimationAnimator);\n  config.container.get(TemplatingEngine).configureAnimator(animator);\n  if (typeof callback === \"function\") { callback(animator); }\n}\n","import { DialogService } from \"aurelia-dialog\";\nimport { EventAggregator } from \"aurelia-event-aggregator\";\nimport { autoinject } from \"aurelia-framework\";\nimport {\n  localStorageMiddleware,\n  MiddlewarePlacement,\n  rehydrateFromLocalStorage,\n  Store\n} from \"aurelia-store\";\nimport { skip, take } from \"rxjs/operators\";\n\nimport {\n  collapsedMines,\n  defiledAltar,\n  forgottenEquipment,\n  pausedResourceProduction,\n  ragingFire,\n  sacrificeResources,\n  stumblingSteps\n} from \"./store/actions/tragedy-events\";\nimport {\n  buyBuilding,\n  buyFortressBuilding,\n  closePurchasePanel,\n  destroyBuilding,\n  LOCALSTORAGE_SAVE_KEY,\n  openPurchaseForTile,\n  reinforceTileBuilding,\n  rollDice,\n  State\n} from \"./store/index\";\n\n@autoinject()\nexport class App {\n  public sidebarVisible: boolean = true;\n\n  constructor(\n    private store: Store<State>,\n    private dialogService: DialogService,\n    private ea: EventAggregator\n  ) {\n    this.store\n      .state\n      .pipe(\n        skip(1),\n        take(1)\n      ).subscribe(() => {\n        this.store.registerMiddleware(\n          localStorageMiddleware,\n          MiddlewarePlacement.After,\n          { key: LOCALSTORAGE_SAVE_KEY }\n        );\n      });\n\n    this.store.registerAction(\"Rehydrate from localstorage\", rehydrateFromLocalStorage);\n    this.store.registerAction(\"roll the dice\", rollDice);\n    this.store.registerAction(\"open the purchase panel\", openPurchaseForTile);\n    this.store.registerAction(\"close the purchase panel\", closePurchasePanel);\n    this.store.registerAction(\"buy a tile building\", buyBuilding);\n    this.store.registerAction(\"destroy a tile building\", destroyBuilding);\n    this.store.registerAction(\"[tragedy] sacrifice resources\", sacrificeResources);\n    this.store.registerAction(\"[tragedy] raging fire\", ragingFire);\n    this.store.registerAction(\"[tragedy] the forgotten equipment\", forgottenEquipment);\n    this.store.registerAction(\"[tragedy] a defiled altar\", defiledAltar);\n    this.store.registerAction(\"[tragedy] paused resource production\", pausedResourceProduction);\n    this.store.registerAction(\"[tragey] collapsed mines\", collapsedMines);\n    this.store.registerAction(\"[tragey] stumbling steps\", stumblingSteps);\n    this.store.registerAction(\"buy fortress building\", buyFortressBuilding);\n    this.store.registerAction(\"reinforce tile building\", reinforceTileBuilding);\n\n    this.store.dispatch(rehydrateFromLocalStorage, LOCALSTORAGE_SAVE_KEY);\n  }\n\n  public attached() {\n    window.addEventListener(\"keyup\", this.handleGlobalKeys);\n  }\n\n  public detached() {\n    window.removeEventListener(\"keyup\", this.handleGlobalKeys);\n  }\n\n  private handleGlobalKeys = (event: KeyboardEvent) => {\n    if (!this.dialogService.hasOpenDialog && event.keyCode === 13) {\n      this.ea.publish(\"key-shortcut\", event.keyCode);\n    }\n  }\n}\n","<template>\n  <require from=\"./main.css\"></require>\n  <div class=\"app\">\n    <button class=\"app__toggle-sidebar\"\n            click.trigger=\"sidebarVisible = !sidebarVisible\">${!sidebarVisible ? \"\" : \"\"}</button>\n    <sidebar class=\"${bem('app', 'sidebar', !sidebarVisible ? 'hidden' : 'visible')}\"></sidebar>\n    <board class=\"app__board\"></board>\n  </div>\n</template>\n","import { autoinject } from \"aurelia-framework\";\nimport { Store } from \"aurelia-store\";\nimport { Subscription } from \"rxjs\";\n\nimport { State } from \"../store/index\";\nimport { openDialog } from \"../utils/utils\";\nimport { GameOver } from \"./game-over\";\nimport { TilePlacement, TileRing } from \"./tile\";\n\n@autoinject()\nexport class Board {\n  public state: State;\n  private subscription: Subscription;\n\n  constructor(private store: Store<State>) {\n    this.subscription = this.store.state.subscribe((state) => {\n      this.state = state;\n\n      if (state.stats.population <= 0) {\n        // game ended\n        openDialog(GameOver, {\n          view: \"board/game-over.html\",\n        });\n      }\n    });\n  }\n\n  public getTiles(ring: TileRing, placement: TilePlacement) {\n    return this.state?.tiles?.filter((t) => t.placement === placement && t.ring === ring);\n  }\n\n  public detached() {\n    this.subscription.unsubscribe();\n  }\n}\n","<template class=\"board\">\n  <div class=\"board__row board__row--top\">\n    <tile repeat.for=\"tile of getTiles('outer', 'top')\"\n          class=\"tile--top\"\n          type.bind=\"tile.type\"\n          is-corner.bind=\"tile.isCorner\"\n          ring.bind=\"tile.ring\"\n          id.bind=\"tile.id\"\n          placement.bind=\"tile.placement\"\n          players.bind=\"state.players\"\n          monsters.bind=\"state.monsters\"\n          stats.bind=\"state.stats\"\n          resources.bind=\"state.resources\"\n          tile-buildings.bind=\"state.tileBuildings\"></tile>\n  </div>\n  <div class=\"board__row board__row--center\">\n    <div class=\"${bem('board', 'col', 'left')}\">\n      <tile repeat.for=\"tile of getTiles('outer', 'left')\"\n            class=\"tile--left\"\n            type.bind=\"tile.type\"\n            is-corner.bind=\"tile.isCorner\"\n            ring.bind=\"tile.ring\"\n            id.bind=\"tile.id\"\n            placement.bind=\"tile.placement\"\n            players.bind=\"state.players\"\n            monsters.bind=\"state.monsters\"\n            stats.bind=\"state.stats\"\n            resources.bind=\"state.resources\"\n            tile-buildings.bind=\"state.tileBuildings\"></tile>\n    </div>\n    <div class=\"${bem('board', 'col', 'center')}\">\n\n      <!-- Inner circle -->\n      <div class=\"board__row board__row--top\">\n        <tile repeat.for=\"tile of getTiles('inner', 'top')\"\n              class=\"tile--top\"\n              type.bind=\"tile.type\"\n              is-corner.bind=\"tile.isCorner\"\n              ring.bind=\"tile.ring\"\n              id.bind=\"tile.id\"\n              placement.bind=\"tile.placement\"\n              players.bind=\"state.players\"\n              monsters.bind=\"state.monsters\"\n              stats.bind=\"state.stats\"\n              resources.bind=\"state.resources\"\n              tile-buildings.bind=\"state.tileBuildings\"></tile>\n      </div>\n      <div class=\"board__row board__row--center\">\n        <div class=\"${bem('board', 'col', 'left')}\">\n          <tile repeat.for=\"tile of getTiles('inner', 'left')\"\n                class=\"tile--left\"\n                type.bind=\"tile.type\"\n                is-corner.bind=\"tile.isCorner\"\n                ring.bind=\"tile.ring\"\n                id.bind=\"tile.id\"\n                placement.bind=\"tile.placement\"\n                players.bind=\"state.players\"\n                monsters.bind=\"state.monsters\"\n                stats.bind=\"state.stats\"\n                resources.bind=\"state.resources\"\n                tile-buildings.bind=\"state.tileBuildings\"></tile>\n        </div>\n        <div class=\"${bem('board', 'col', 'center')}\">\n          <fortress class=\"board__fortress\"></fortress>\n        </div>\n        <div class=\"${bem('board', 'col', 'right')}\">\n          <tile repeat.for=\"tile of getTiles('inner', 'right')\"\n                class=\"tile--right\"\n                type.bind=\"tile.type\"\n                is-corner.bind=\"tile.isCorner\"\n                ring.bind=\"tile.ring\"\n                id.bind=\"tile.id\"\n                placement.bind=\"tile.placement\"\n                players.bind=\"state.players\"\n                monsters.bind=\"state.monsters\"\n                stats.bind=\"state.stats\"\n                resources.bind=\"state.resources\"\n                tile-buildings.bind=\"state.tileBuildings\"></tile>\n        </div>\n      </div>\n      <div class=\"board__row board__row--bottom\">\n        <tile repeat.for=\"tile of getTiles('inner', 'bottom')\"\n              class=\"tile--bottom\"\n              type.bind=\"tile.type\"\n              is-corner.bind=\"tile.isCorner\"\n              ring.bind=\"tile.ring\"\n              id.bind=\"tile.id\"\n              placement.bind=\"tile.placement\"\n              players.bind=\"state.players\"\n              monsters.bind=\"state.monsters\"\n              stats.bind=\"state.stats\"\n              resources.bind=\"state.resources\"\n              tile-buildings.bind=\"state.tileBuildings\"></tile>\n      </div>\n      <!-- /Inner circle -->\n\n    </div>\n    <div class=\"${bem('board', 'col', 'right')}\">\n      <tile repeat.for=\"tile of getTiles('outer', 'right')\"\n            class=\"tile--right\"\n            type.bind=\"tile.type\"\n            is-corner.bind=\"tile.isCorner\"\n            ring.bind=\"tile.ring\"\n            id.bind=\"tile.id\"\n            placement.bind=\"tile.placement\"\n            players.bind=\"state.players\"\n            monsters.bind=\"state.monsters\"\n            stats.bind=\"state.stats\"\n            resources.bind=\"state.resources\"\n            tile-buildings.bind=\"state.tileBuildings\"></tile>\n    </div>\n  </div>\n  <div class=\"board__row board__row--bottom\">\n    <tile repeat.for=\"tile of getTiles('outer', 'bottom')\"\n          class=\"tile--bottom\"\n          type.bind=\"tile.type\"\n          is-corner.bind=\"tile.isCorner\"\n          ring.bind=\"tile.ring\"\n          id.bind=\"tile.id\"\n          placement.bind=\"tile.placement\"\n          players.bind=\"state.players\"\n          monsters.bind=\"state.monsters\"\n          stats.bind=\"state.stats\"\n          resources.bind=\"state.resources\"\n          tile-buildings.bind=\"state.tileBuildings\"></tile>\n  </div>\n</template>\n","import { connectTo } from \"aurelia-store\";\nimport { State } from \"../store/index\";\n\n@connectTo()\nexport class Fortress {\n  public state: State;\n}\n","<template class=\"fortress\">\n  <span class=\"fortress__caption\">Fortress</span>\n\n  <div class=\"fortress__buildings\">\n    <fortress-building repeat.for=\"building of state.fortressBuildings\"\n                       type.bind=\"building.type\"\n                       class=\"fortress__building\"></fortress-building>\n  </div>\n</template>\n","import { autoinject } from \"aurelia-framework\";\nimport { Store } from \"aurelia-store\";\n\nimport {\n  initialState,\n  LOCALSTORAGE_SAVE_KEY,\n  State\n} from \"../store/index\";\nimport { DialogModel } from \"../utils/utils\";\n\n@autoinject()\nexport class GameOver {\n  public dialogView: string;\n  public bemclasses: string;\n\n  constructor(\n    private store: Store<State>\n  ) { }\n\n  public newGame() {\n    this.store.resetToState(initialState);\n    window.localStorage.removeItem(LOCALSTORAGE_SAVE_KEY);\n    window.location.reload();\n  }\n\n  public activate(model: GameOver & DialogModel) {\n    this.dialogView = model.view;\n    this.bemclasses = model.bem;\n  }\n}\n","<template class=\"game-over\">\n  <h4 class=\"game-over__header\">Game over</h4>\n\n  <p class=\"game-over__text\">You fought brave, you fought ferocious.<br />\n    But as the night fell so has your fort.<br />\n    Tis' not the end though. <br />\n    Start your journey anew and prepare better this time.</p>\n\n  <button class=\"game-over__new-game\"\n          click.trigger=\"newGame()\">Restart game</button>\n</template>\n","import { FrameworkConfiguration } from \"aurelia-framework\";\nimport { Board } from \"./board\";\nimport { Fortress } from \"./fortress\";\nimport { GameOver } from \"./game-over\";\nimport { Tile } from \"./tile\";\nimport { Tragedy } from \"./tragedy\";\n\nexport function configure(config: FrameworkConfiguration) {\n  config.globalResources([\n    Board,\n    Fortress,\n    GameOver,\n    Tile,\n    Tragedy\n  ]);\n}\n","import { autoinject, bindable, computedFrom } from \"aurelia-framework\";\nimport { Store } from \"aurelia-store\";\nimport { capitalize } from \"lodash\";\n\nimport { WebAnimationAnimator } from \"../animator/animator\";\nimport { ConstructionPanel } from \"../buildings/construction-panel\";\nimport { PurchasePanel } from \"../buildings/purchase-panel\";\nimport { TileBuilding } from \"../buildings/tile-building\";\nimport { Monster } from \"../monster/monster\";\nimport { Player } from \"../player/player\";\nimport { Resources, Stats } from \"../resources/index\";\nimport { openPurchaseForTile, State } from \"../store/index\";\nimport { openDialog } from \"../utils/utils\";\nimport { Tragedy } from \"./tragedy\";\n\nexport type TileType = \"wood\"\n  | \"stone\"\n  | \"food\"\n  | \"gold\"\n  | \"iron\"\n  | \"coal\"\n  | \"mana\"\n  | \"blood\"\n  | \"start\"\n  | \"rally_point\"\n  | \"sacred_grounds\"\n  | \"construction-site\"\n  | \"tragedy\"\n  | \"fire_fountain\";\n\nexport type TilePlacement = \"bottom\" | \"left\" | \"top\" | \"right\";\nexport type TileRing = \"inner\" | \"outer\";\n\n@autoinject()\nexport class Tile {\n  @bindable public type: TileType;\n  @bindable public placement: TilePlacement;\n  @bindable public isCorner: boolean = false;\n  @bindable public ring: \"inner\" | \"outer\";\n  @bindable public players?: Player[] = [];\n  @bindable public monsters?: Monster[] = [];\n  @bindable public tileBuildings?: TileBuilding[] = [];\n  @bindable public id: string;\n  @bindable public resources: Resources;\n  @bindable public stats: Stats;\n\n  constructor(\n    private store: Store<State>,\n    private animator: WebAnimationAnimator,\n    private element: Element\n  ) { }\n\n  public async playersChanged() {\n    if (this.type === \"tragedy\" && this.isPlayerOnTile) {\n      this.animator.animate(this.element, {\n        backgroundColor: [\"transparent\", \"red\", \"transparent\", \"red\"]\n      }, 2000);\n      await openDialog(Tragedy, {\n        view: \"board/tragedy.html\"\n      }, \"Enter\");\n    }\n  }\n\n  @computedFrom(\"players\")\n  public get isPlayerOnTile() {\n    return this.players?.filter((p) => p.currentTileId === this.id).length > 0;\n  }\n\n  @computedFrom(\"monsters\")\n  public get monstersOnTile() {\n    return this.monsters?.filter((p) => p.currentTileId === this.id);\n  }\n\n  @computedFrom(\"tileBuildings\")\n  public get isBuildingOnTile() {\n    return this.tileBuildings?.filter((b) => b.tileId === this.id).length > 0;\n  }\n\n  @computedFrom(\"type\")\n  public get typeName() {\n    return capitalize(this.type.replace(/_|-/g, \" \"));\n  }\n\n  public get tileBuilding() {\n    return this.tileBuildings?.find((b) => b.tileId === this.id);\n  }\n\n  public async openPurchasePanel() {\n    if (\n      ![\"start\", \"rally_point\", \"tragedy\",\n        \"construction-site\", \"fire_fountain\"].includes(this.type) && this.isPlayerOnTile\n    ) {\n      await this.store.dispatch(openPurchaseForTile, this);\n\n      openDialog(PurchasePanel, {\n        resources: this.resources,\n        stats: this.stats,\n        tile: this,\n        tileBuilding: this.tileBuildings?.find((b) => b.tileId === this.id),\n        view: \"buildings/purchase-panel.html\",\n      });\n    } else if (this.type === \"construction-site\" && this.isPlayerOnTile) {\n      openDialog(ConstructionPanel, {\n        resources: this.resources,\n        view: \"buildings/construction-panel.html\",\n      });\n    }\n  }\n}\n","<template title.bind=\"typeName\"\n          dblclick.delegate=\"openPurchasePanel()\"\n          class=\"${bem('tile', '', [type, isCorner && 'corner'])}\">\n  <player repeat.for=\"player of players\"\n          if.bind=\"isPlayerOnTile\"\n          class=\"tile__player\"\n          name.bind=\"player.name\"\n          current-tile-id.bind=\"$parent.id\"></player>\n\n  <tile-building if.bind=\"isBuildingOnTile\"\n                 tile-id.bind=\"id\"\n                 type.bind=\"tileBuilding.type\"\n                 placement.bind=\"placement\"></tile-building>\n\n  <monster repeat.for=\"monster of monstersOnTile\"\n           if.bind=\"monstersOnTile\"\n           class=\"tile__monster\"\n           current-tile-id.bind=\"$parent.id\"\n           stats.bind=\"monster.stats\"\n           type.bind=\"monster.type\"></monster>\n</template>\n","import { DialogController } from \"aurelia-dialog\";\nimport { autoinject } from \"aurelia-framework\";\nimport { Store } from \"aurelia-store\";\nimport { take } from \"rxjs/operators\";\n\nimport { AvailableTileBuildings } from \"../buildings/tile-building\";\nimport {\n  collapsedMines,\n  defiledAltar,\n  forgottenEquipment,\n  pausedResourceProduction,\n  ragingFire,\n  sacrificeResources,\n  stumblingSteps\n} from \"../store/actions/tragedy-events\";\nimport { randBetween } from \"../store/helper\";\nimport { State } from \"../store/state\";\nimport { DialogModel } from \"../utils/utils\";\n\n@autoinject()\nexport class Tragedy {\n  public dialogView?: string;\n  public bemclasses?: string;\n  public event?: TragedyEvent;\n  public state: State;\n\n  constructor(\n    public store: Store<State>,\n    public controller: DialogController\n  ) { }\n\n  public activate(model: DialogModel) {\n    this.dialogView = model.view;\n    this.bemclasses = model.bem;\n\n    // only subscribe for one state so we don't run into rerender cycles\n    this.store.state.pipe(take(1)).subscribe((state) => {\n      this.state = state;\n\n      if (this.state.activeTragedy !== undefined) {\n        this.event = {\n          effect: () => `You beared more tragedy than a poor soul can handle`,\n          event: -1,\n          image: \"prayer\",\n          name: \"No more tragedy\",\n          weight: 0,\n        } as TragedyEvent;\n      } else {\n        this.drawRandomTragedyEvent();\n      }\n    });\n  }\n\n  private drawRandomTragedyEvent() {\n    let sum = 0;\n    const r = Math.random();\n    const probability: { [key: number]: number } = tragedyEvents.reduce((acc, curr, idx) => {\n      acc[idx] = curr.weight;\n\n      return acc;\n    }, {});\n\n    for (const i in probability) {\n      if (probability.hasOwnProperty(i)) {\n        sum += probability[i];\n        if (r <= sum) {\n          this.event = tragedyEvents[parseInt(i.toString(), 10)];\n          break;\n        }\n      }\n    }\n  }\n}\n\nexport enum AvailableTragedyEvents {\n  Sacrifice,\n  RagingFire,\n  StumblingSteps,\n  ForgottenEquipment,\n  DefiledAltar,\n  CollapsedMines,\n  Vermins,\n  Rockfall,\n  ShatteringEarth,\n  BurningTrees,\n  ContaminatedBlood\n}\n\nexport interface TragedyEvent {\n  /**\n   * defines the probability this event gets picked\n   * Must be lower 1. Sum of all weights must be 1\n   */\n  weight: number;\n  name: string;\n  image: string;\n  event: AvailableTragedyEvents;\n  /**\n   * performs the events effects and returns the description\n   */\n  effect: (store: Store<State>, state: State) => string;\n}\n\nexport const tragedyEvents: TragedyEvent[] = [\n  {\n    effect: (store, state) => {\n      const amount = randBetween(1, 4);\n      const availableResources = Object.keys(state.resources)\n        .filter((r) => state.resources[r] > 0);\n      const resourceType = availableResources[randBetween(0, availableResources.length - 1)];\n      const description = `In order to please the gods you sacrifice ${amount} of your ${resourceType}.`;\n\n      store.dispatch(sacrificeResources, resourceType, amount);\n\n      return description;\n    },\n    event: AvailableTragedyEvents.Sacrifice,\n    image: \"sacrificial-dagger\",\n    name: \"A sacrifice for the gods\",\n    weight: 0.08\n  },\n  {\n    effect: (store, state) => {\n      if (state.tileBuildings.length === 0) {\n        return \"A building burned to the ground, but luckily it was none of yours.\";\n      }\n\n      const targetBuilding = state.tileBuildings[randBetween(0, state.tileBuildings.length - 1)];\n      const description = `A fire broke out! Your ${targetBuilding.type} burned to the ground.`;\n\n      store.dispatch(ragingFire, targetBuilding.tileId);\n\n      return description;\n    },\n    event: AvailableTragedyEvents.RagingFire,\n    image: \"small-fire\",\n    name: \"Raging fire\",\n    weight: 0.07\n  },\n  {\n    effect: (store) => {\n      store.dispatch(stumblingSteps);\n\n      return \"Your last nights tavern demands it's toll. Your next dice rolls are wonky small steps.\";\n    },\n    event: AvailableTragedyEvents.StumblingSteps,\n    image: \"beer-stein\",\n    name: \"Stumbling steps\",\n    weight: 0.12\n  },\n  {\n    effect: (store) => {\n      store.dispatch(forgottenEquipment);\n\n      return \"You were in such a hurry rushing for the adventure leaving your essentials at the door steps. Go back to the start of your journey and get them.\";\n    },\n    event: AvailableTragedyEvents.ForgottenEquipment,\n    image: \"bindle\",\n    name: \"The forgotten equipment\",\n    weight: 0.11\n  },\n  {\n    effect: (store, state) => {\n      const shrines = state.tileBuildings.filter((tb) => tb.type === \"shrine\");\n      if (shrines.length === 0) {\n        return \"A shrine has been defiled, yet it was one for the wrong gods.\";\n      }\n\n      store.dispatch(defiledAltar);\n\n      return \"Strangers have been seen, defiling one of your shrines. 'Tis your duty to rebuild them in full glory.\";\n    },\n    event: AvailableTragedyEvents.DefiledAltar,\n    image: \"broken-tablet\",\n    name: \"Defiled altar\",\n    weight: 0.07\n  },\n  {\n    effect: (store) => {\n      const mineTypes: AvailableTileBuildings[] = [\n        \"gold_mine\", \"iron_mine\", \"coal_mine\"\n      ];\n\n      const mineType = mineTypes[randBetween(0, mineTypes.length)];\n      const description = `Men screamed and shouted, sealed in the dark groves of your ${mineType}. Poor devils souls, for their life found it's end in the dark.`;\n\n      store.dispatch(collapsedMines, mineType);\n\n      return description;\n    },\n    event: AvailableTragedyEvents.CollapsedMines,\n    image: \"oppression\",\n    name: \"Collapsed mines\",\n    weight: 0.10\n  },\n  {\n    effect: (store) => {\n      store.dispatch(pausedResourceProduction, AvailableTragedyEvents.Vermins);\n\n      return `Your mills got pested by pesky vermins. Until the mess is cleaned no food may be produced.`;\n    },\n    event: AvailableTragedyEvents.Vermins,\n    image: \"rat\",\n    name: \"Plague of vermins\",\n    weight: 0.09\n  },\n  {\n    effect: (store) => {\n      store.dispatch(pausedResourceProduction, AvailableTragedyEvents.Rockfall);\n\n      return `Those giant boulders set loose and burried few of your men. It will take a while until the next shipment is ready.`;\n    },\n    event: AvailableTragedyEvents.Rockfall,\n    image: \"falling-rocks\",\n    name: \"The rockfall\",\n    weight: 0.09\n  },\n  {\n    effect: (store) => {\n      store.dispatch(pausedResourceProduction, AvailableTragedyEvents.ShatteringEarth);\n\n      return `A mighty earth quake shattered your mana rifts. It is nature that shows it's endless power. It will take a wihle until further veils can be casted.`;\n    },\n    event: AvailableTragedyEvents.ShatteringEarth,\n    image: \"earth-spit\",\n    name: \"Shattering earth\",\n    weight: 0.09\n  },\n  {\n    effect: (store) => {\n      store.dispatch(pausedResourceProduction, AvailableTragedyEvents.BurningTrees);\n\n      return `A morron with a torch, none of wisdom on his porch, set ablaze your woods. No more lumber is going soon to find the routes.`;\n    },\n    event: AvailableTragedyEvents.BurningTrees,\n    image: \"burning-tree\",\n    name: \"Burning trees\",\n    weight: 0.09\n  },\n  {\n    effect: (store) => {\n      store.dispatch(pausedResourceProduction, AvailableTragedyEvents.ContaminatedBlood);\n\n      return `One of the corpses was filled with evil gazes. It will take a while to harvest another crop.`;\n    },\n    event: AvailableTragedyEvents.ContaminatedBlood,\n    image: \"infested-mass\",\n    name: \"Contaminated blood\",\n    weight: 0.09\n  }\n];\n","<template class=\"tragedy\">\n  <h4 class=\"tragedy__header\">${event.name}</h4>\n  <img src=\"assets/icons/${event.image}.svg\"\n       class=\"tragedy__image\"\n       alt=\"The chosen tragedy\">\n  <p class=\"tragedy__description\">${event.effect(store, state)}</p>\n  <button class=\"tragedy__button\"\n          data-aid=\"btn-tragedy-accept\"\n          click.trigger=\"controller.ok()\">${event.event === -1 ? \"Praise the gods and continue your journey\" : \"Accept\n    the fate\"}</button>\n</template>\n","import { DialogController } from \"aurelia-dialog\";\nimport { autoinject, bindable, computedFrom } from \"aurelia-framework\";\nimport { Store } from \"aurelia-store\";\nimport { capitalize } from \"lodash\";\n\nimport { take } from \"rxjs/operators\";\nimport { Resources, ResourcesIcons } from \"../resources/index\";\nimport { buyFortressBuilding, State } from \"../store/index\";\nimport { DialogModel } from \"../utils/utils\";\nimport {\n  AllFortressBuildings,\n  FortressBuilding,\n  FortressBuildingIcon,\n  FortressBuildingResourceCost\n} from \"./fortress-building\";\n\n@autoinject()\nexport class ConstructionPanel {\n  @bindable() public resources: Resources;\n  public dialogView: string;\n  public bemclasses: string;\n  public currentBuildingIdx = 0;\n  public buildingInProgress: boolean;\n\n  private fortressBuildings;\n\n  constructor(\n    private store: Store<State>,\n    public controller: DialogController\n  ) { }\n\n  @computedFrom(\"currentBuildingIdx\")\n  public get building(): FortressBuilding {\n    return this.fortressBuildings[this.currentBuildingIdx];\n  }\n\n  @computedFrom(\"fortressBuildings\")\n  public get buildingsLeftToBuild() {\n    return !!this.fortressBuildings.length;\n  }\n\n  public activate(model: ConstructionPanel & DialogModel) {\n    this.resources = model.resources;\n    this.dialogView = model.view;\n    this.bemclasses = model.bem;\n\n    this.store.state.pipe(take(1)).subscribe((state) => {\n      this.buildingInProgress = !!state.activeFortressBuildingConstruction;\n      this.fortressBuildings = AllFortressBuildings.filter((b) =>\n        !state.fortressBuildings.find((fb) => fb.type === b)\n      ).map((b) => {\n        const buildingCosts = Object.entries<number>(FortressBuildingResourceCost[b]).filter((r) => r[1] !== 0);\n        const costs = buildingCosts.map((e) => ({\n          icon: ResourcesIcons[e[0]],\n          resource: e[0],\n          value: e[1],\n        }));\n\n        return {\n          costs,\n          icon: FortressBuildingIcon[b],\n          name: capitalize(b.replace(/_/g, \" \")),\n          sufficientResources: !costs.some((c) => this.resources[c.resource] - c.value < 0),\n          type: b\n        };\n      });\n    });\n  }\n\n  public closePanel() {\n    this.controller.cancel();\n  }\n\n  public toggleBuilding(direction: \"-\" | \"+\") {\n    if (direction === \"+\") {\n      this.currentBuildingIdx = (this.currentBuildingIdx + 1) > (this.fortressBuildings.length - 1)\n        ? 0\n        : this.currentBuildingIdx + 1;\n    } else {\n      this.currentBuildingIdx = (this.currentBuildingIdx - 1) < 0\n        ? this.fortressBuildings.length - 1\n        : this.currentBuildingIdx - 1;\n    }\n  }\n\n  public async buyBuilding() {\n    await this.store.dispatch(buyFortressBuilding, this.building.type);\n    this.controller.ok();\n  }\n}\n","<template class=\"construction-panel\">\n  <h4 class=\"construction-panel__header\">Fortress Buildings</h4>\n  <div class=\"construction-panel__message\"\n       if.bind=\"!buildingsLeftToBuild\">No buildings left to construct</div>\n  <div class=\"construction-panel__message\"\n       if.bind=\"buildingsLeftToBuild && buildingInProgress\">Cannot construct another building this round</div>\n  <ul if.bind=\"buildingsLeftToBuild && !buildingInProgress\"\n      class=\"construction-panel__list\">\n    <li class=\"construction-panel__item\">\n      <div class=\"construction-panel__building-name\">\n        <button class=\"construction-panel__building-navigator\"\n                click.trigger=\"toggleBuilding('-')\">&#x2B05;</button>\n        <img title.bind=\"building.name\"\n             class=\"construction-panel__building-icon\"\n             alt=\"The buildings icon\"\n             src=\"assets/icons/${building.icon}.svg\" />\n        <button class=\"construction-panel__building-navigator\"\n                click.trigger=\"toggleBuilding('+')\">&#x27A1;</button>\n      </div>\n      <ul class=\"construction-panel__cost cost\">\n        <li repeat.for=\"cost of building.costs\"\n            class=\"cost__item\">\n          <img src=\"assets/icons/${cost.icon}.svg\"\n               title.bind=\"cost.resource\"\n               alt.bind=\"cost.resource\"\n               class=\"cost__icon\" />\n          <span class=\"cost__value\">${cost.value}</span>\n        </li>\n      </ul>\n      <button class=\"construction-panel__buy\"\n              click.trigger=\"buyBuilding()\"\n              data-aid=\"btn-buy-fortress-building\"\n              disabled.bind=\"!building.sufficientResources\"\n              title.bind=\"!building.sufficientResources ? 'Not enough resources' : 'Buy'\">Buy</button>\n    </li>\n  </ul>\n\n  <button class=\"construction-panel__close\"\n          click.trigger=\"closePanel()\">Close</button>\n</template>\n","import { bindable, computedFrom } from \"aurelia-framework\";\nimport { capitalize } from \"lodash\";\n\nimport { Resources } from \"../resources/index\";\n\nexport const AllFortressBuildings = [\n  \"blacksmith_shop\",\n  \"magician_tower\",\n  \"bakery\",\n  \"palisades\",\n  \"bank\"\n] as const;\n\nexport type AvailableFortressBuildings = (typeof AllFortressBuildings)[number];\n\nexport enum FortressBuildingIcon {\n  bakery = \"dough-roller\",\n  bank = \"gold-stack\",\n  blacksmith_shop = \"anvil\",\n  magician_tower = \"evil-tower\",\n  palisades = \"palisade\"\n}\n\nexport const FortressBuildingResourceCost: {\n  [key in AvailableFortressBuildings]: Resources;\n} = {\n  bakery: {\n    blood: 0,\n    coal: 0,\n    food: 10,\n    gold: 10,\n    iron: 0,\n    mana: 0,\n    stone: 10,\n    wood: 10\n  },\n  bank: {\n    blood: 0,\n    coal: 0,\n    food: 10,\n    gold: 10,\n    iron: 0,\n    mana: 0,\n    stone: 10,\n    wood: 10\n  },\n  blacksmith_shop: {\n    blood: 0,\n    coal: 0,\n    food: 10,\n    gold: 10,\n    iron: 0,\n    mana: 0,\n    stone: 10,\n    wood: 10\n  },\n  magician_tower: {\n    blood: 0,\n    coal: 0,\n    food: 10,\n    gold: 10,\n    iron: 0,\n    mana: 0,\n    stone: 10,\n    wood: 10\n  },\n  palisades: {\n    blood: 0,\n    coal: 0,\n    food: 10,\n    gold: 10,\n    iron: 0,\n    mana: 0,\n    stone: 10,\n    wood: 10\n  }\n};\n\nexport class FortressBuilding {\n  @bindable() public type: AvailableFortressBuildings;\n\n  @computedFrom(\"type\")\n  public get icon(): string {\n    return FortressBuildingIcon[this.type];\n  }\n\n  @computedFrom(\"type\")\n  public get name(): string {\n    return capitalize(this.type.replace(/_/g, \" \"));\n  }\n}\n","<template class=\"fortress-building\">\n  <img class=\"fortress-building__icon\"\n       title.bind=\"name\"\n       alt=\"A fortress building\"\n       src=\"assets/icons/${icon}.svg\" />\n</template>\n","import { FrameworkConfiguration } from \"aurelia-framework\";\nimport { ConstructionPanel } from \"./construction-panel\";\nimport { FortressBuilding } from \"./fortress-building\";\nimport { PurchasePanel } from \"./purchase-panel\";\nimport { TileBuilding } from \"./tile-building\";\n\nexport function configure(config: FrameworkConfiguration) {\n  config.globalResources([\n    ConstructionPanel,\n    FortressBuilding,\n    PurchasePanel,\n    TileBuilding\n  ]);\n}\n","import { DialogController } from \"aurelia-dialog\";\nimport { autoinject, bindable, computedFrom } from \"aurelia-framework\";\nimport { Store } from \"aurelia-store\";\nimport { capitalize, upperFirst } from \"lodash\";\n\nimport { Tile } from \"../board/tile\";\nimport { Resources, ResourcesIcons, Stats } from \"../resources/index\";\nimport {\n  buyBuilding,\n  closePurchasePanel,\n  destroyBuilding,\n  reinforceTileBuilding,\n  State\n} from \"../store/index\";\nimport { DialogModel } from \"../utils/utils\";\nimport {\n  MAX_SOLDIERS,\n  TileBuilding,\n  TileBuildingResourceCost,\n  TileBuildingsIcon,\n  TileBuildingsMap\n} from \"./tile-building\";\n\n@autoinject()\nexport class PurchasePanel {\n  @bindable() public tile: Tile;\n  @bindable() public tileBuilding?: TileBuilding;\n  @bindable() public resources: Resources;\n  @bindable() public stats: Stats;\n  public dialogView?: string;\n  public bemclasses?: string;\n\n  constructor(\n    private store: Store<State>,\n    public controller: DialogController\n  ) { }\n\n  public activate(model: PurchasePanel & DialogModel) {\n    this.tile = model.tile;\n    this.tileBuilding = model.tileBuilding;\n    this.resources = model.resources;\n    this.stats = model.stats;\n    this.dialogView = model.view;\n    this.bemclasses = model.bem;\n  }\n\n  @computedFrom(\"tile\")\n  public get building() {\n    return TileBuildingsMap[this.tile.type];\n  }\n\n  @computedFrom(\"tile\")\n  public get buildingName() {\n    return capitalize(TileBuildingsMap[this.tile.type].replace(/_/g, \" \"));\n  }\n\n  @computedFrom(\"stats.soldiers\", \"tileBuilding.garrison\")\n  public get soldiersLeft() {\n    return this.stats.soldiers > 0 && this.tileBuilding.garrison < MAX_SOLDIERS;\n  }\n\n  @computedFrom(\"tile\")\n  public get costs() {\n    const entries = Object.entries<number>(TileBuildingResourceCost[this.building]).filter((r) => r[1] !== 0);\n\n    return entries.map((e) => ({\n      icon: ResourcesIcons[e[0]],\n      resource: upperFirst(e[0]),\n      value: e[1],\n    }));\n  }\n\n  @computedFrom(\"resources\")\n  public get sufficientResources() {\n    return !this.costs.some((c) => this.resources[c.resource.toLowerCase()] - c.value < 0);\n  }\n\n  @computedFrom(\"tileBuilding\")\n  public get buildingIcon() {\n    return TileBuildingsIcon[this.building];\n  }\n\n  public buyBuilding() {\n    const newBuilding = {} as TileBuilding;\n    newBuilding.tileId = this.tile.id;\n    newBuilding.type = TileBuildingsMap[this.tile.type];\n    newBuilding.placement = this.tile.placement;\n    newBuilding.garrison = 0;\n\n    this.store.pipe(buyBuilding, newBuilding).pipe(closePurchasePanel).dispatch();\n    this.controller.ok();\n  }\n\n  public destroyBuilding() {\n    this.store.pipe(destroyBuilding, this.tileBuilding.tileId).pipe(closePurchasePanel).dispatch();\n    this.controller.ok();\n  }\n\n  public reinforceBuilding() {\n    this.store.pipe(reinforceTileBuilding, this.tileBuilding.tileId).pipe(closePurchasePanel).dispatch();\n    this.controller.ok();\n  }\n\n  public closePanel() {\n    this.store.dispatch(closePurchasePanel);\n    this.controller.cancel();\n  }\n}\n","<template class=\"purchase-panel\">\n  <div class=\"purchase-panel__top-bar\">\n    <h4 class=\"purchase-panel__header\">Building</h4>\n    <div class=\"purchase-panel__garrison\">\n      <img class=\"purchase-panel__stats-icon\"\n           src=\"assets/icons/sword-brandish.svg\"\n           alt=\"Garrisoned building\"\n           repeat.for=\"soldier of tileBuilding.garrison\" />\n    </div>\n  </div>\n  <ul class=\"purchase-panel__list\">\n    <li class=\"purchase-panel__item\">\n      <span class=\"purchase-panel__building-name\">\n        <img title.bind=\"buildingName\"\n             class=\"purchase-panel__building-icon\"\n             alt=\"A tile building\"\n             src=\"assets/icons/${buildingIcon}.svg\" />\n      </span>\n      <ul class=\"purchase-panel__cost cost\">\n        <li repeat.for=\"cost of costs\"\n            class=\"cost__item\">\n          <img src=\"assets/icons/${cost.icon}.svg\"\n               title.bind=\"cost.resource\"\n               alt.bind=\"cost.resource\"\n               class=\"cost__icon\" />\n          <span class=\"cost__value\">${cost.value}</span>\n        </li>\n      </ul>\n      <button class=\"purchase-panel__button\"\n              click.trigger=\"buyBuilding()\"\n              data-aid=\"btn-buy\"\n              disabled.bind=\"tileBuilding || !sufficientResources\"\n              title.bind=\"!sufficientResources ? 'Not enough resources' : 'Buy'\">Buy</button>\n      <button class=\"purchase-panel__button\"\n              click.trigger=\"destroyBuilding()\"\n              data-aid=\"btn-destroy\"\n              disabled.bind=\"!tileBuilding\"\n              title.bind=\"!tileBuilding ? 'Nothing built yet' : 'Destroy the building'\">Destroy</button>\n      <button class=\"purchase-panel__button\"\n              click.trigger=\"reinforceBuilding()\"\n              data-aid=\"btn-reinforce-building\"\n              disabled.bind=\"!tileBuilding || !soldiersLeft\"\n              title.bind=\"!tileBuilding ? 'Nothing built yet' : 'Reinforce with an additional soldier'\">Reinforce</button>\n\n    </li>\n  </ul>\n\n  <button class=\"purchase-panel__close\"\n          click.trigger=\"closePanel()\">Close</button>\n</template>\n","import { bindable, computedFrom } from \"aurelia-framework\";\nimport { TilePlacement, TileType } from \"../board/tile\";\nimport { Resources } from \"../resources/index\";\n\nexport type AvailableTileBuildings = \"sawmill\"\n  | \"quarry\"\n  | \"farm\"\n  | \"gold_mine\"\n  | \"iron_mine\"\n  | \"mana_rift\"\n  | \"butchery\"\n  | \"coal_mine\"\n  | \"shrine\";\n\nexport enum TileBuildingsIcon {\n  butchery = \"meat-cleaver\",\n  coal_mine = \"coal-wagon\",\n  farm = \"windmill\",\n  gold_mine = \"gold-mine\",\n  iron_mine = \"mining\",\n  mana_rift = \"magic-portal\",\n  quarry = \"stone-crafting\",\n  sawmill = \"crosscut-saw\",\n  shrine = \"fire-shrine\"\n}\n\nexport const TileBuildingResourceCost: {\n  [key in AvailableTileBuildings]: Resources;\n} = {\n  butchery: {\n    blood: 0,\n    coal: 0,\n    food: 0,\n    gold: 10,\n    iron: 0,\n    mana: 0,\n    stone: 0,\n    wood: 10\n  },\n  coal_mine: {\n    blood: 0,\n    coal: 0,\n    food: 0,\n    gold: 10,\n    iron: 0,\n    mana: 0,\n    stone: 0,\n    wood: 10\n  },\n  farm: {\n    blood: 0,\n    coal: 0,\n    food: 0,\n    gold: 6,\n    iron: 0,\n    mana: 0,\n    stone: 0,\n    wood: 6\n  },\n  gold_mine: {\n    blood: 0,\n    coal: 0,\n    food: 7,\n    gold: 0,\n    iron: 0,\n    mana: 0,\n    stone: 5,\n    wood: 12\n  },\n  iron_mine: {\n    blood: 0,\n    coal: 0,\n    food: 0,\n    gold: 10,\n    iron: 0,\n    mana: 0,\n    stone: 0,\n    wood: 10\n  },\n  mana_rift: {\n    blood: 0,\n    coal: 0,\n    food: 0,\n    gold: 10,\n    iron: 0,\n    mana: 0,\n    stone: 0,\n    wood: 10\n  },\n  quarry: {\n    blood: 0,\n    coal: 0,\n    food: 5,\n    gold: 8,\n    iron: 0,\n    mana: 0,\n    stone: 0,\n    wood: 9\n  },\n  sawmill: {\n    blood: 0,\n    coal: 0,\n    food: 0,\n    gold: 5,\n    iron: 0,\n    mana: 0,\n    stone: 0,\n    wood: 4\n  },\n  shrine: {\n    blood: 0,\n    coal: 0,\n    food: 10,\n    gold: 15,\n    iron: 0,\n    mana: 0,\n    stone: 10,\n    wood: 10\n  }\n};\n\nexport const BASE_DMG = 5;\nexport const DMG_PER_SOLDIER = 2;\nexport const MAX_SOLDIERS = 3;\n\nexport function calculateDmg(garrison) {\n  return BASE_DMG + ((garrison || 0) * DMG_PER_SOLDIER);\n}\n\nexport const TileBuildingsMap: {\n  [key in Exclude<TileType, \"start\"\n    | \"rally_point\"\n    | \"tragedy\"\n    | \"construction-site\"\n    | \"fire_fountain\">]: AvailableTileBuildings\n} = {\n  blood: \"butchery\",\n  coal: \"coal_mine\",\n  food: \"farm\",\n  gold: \"gold_mine\",\n  iron: \"iron_mine\",\n  mana: \"mana_rift\",\n  sacred_grounds: \"shrine\",\n  stone: \"quarry\",\n  wood: \"sawmill\",\n};\n\nexport class TileBuilding {\n  @bindable public tileId: string;\n  @bindable public type: AvailableTileBuildings;\n  @bindable public placement: TilePlacement;\n  @bindable public garrison: 0 | 1 | 2 | 3;\n\n  @computedFrom(\"garrison\")\n  public get dmg() {\n    return calculateDmg(this.garrison);\n  }\n}\n","<template class=\"${bem('tile-building', '', [placement])} au-animate\">\n  <div class=\"${bem('tile-building', 'display', [type, placement])}\"></div>\n</template>\n","export default {\n  debug: true,\n  testing: true\n};\n","import { Aurelia } from \"aurelia-framework\";\nimport { rehydrateFromLocalStorage } from \"aurelia-store\";\nimport \"web-animations-js\";\n\nimport { WebAnimationAnimator } from \"./animator/animator\";\nimport environment from \"./environment\";\nimport { initialState, LOCALSTORAGE_SAVE_KEY, State } from \"./store/index\";\n\nif (\"serviceWorker\" in navigator) {\n  navigator.serviceWorker.register(\"/enforted/sw.js\", { scope: \".\" }).then((reg) => {\n    // tslint:disable-next-line:no-console\n    console.log(\"Successfully registered service worker. Scope is \" + reg.scope);\n  }).catch((error) => {\n    // tslint:disable-next-line:no-console\n    console.log(\"Failed registering service worker \" + error);\n  });\n}\n\nexport async function configure(aurelia: Aurelia) {\n  aurelia.use\n    .standardConfiguration()\n    .plugin(\"aurelia-bem\")\n    .plugin(\"aurelia-store\", {\n      initialState\n    })\n    .plugin(\"aurelia-dialog\")\n    .feature(\"board\")\n    .feature(\"player\")\n    .feature(\"monster\")\n    .feature(\"sidebar\")\n    .feature(\"buildings\");\n\n  aurelia.use.developmentLogging(environment.debug ? \"debug\" : \"warn\");\n\n  if (!(window as any).Cypress) {\n    aurelia.use.feature(\"animator\", (instance: WebAnimationAnimator) => {\n      instance.storedEnterAnimations[\"TILE-BUILDING\"] = {\n        keyframes: [\n          { transform: \"translate3d(0, 50%, 0)\", opacity: \"0\" },\n          { transform: \"translate3d(0, 0, 0)\", opacity: \"1\" }\n        ],\n        options: 300\n      };\n      instance.storedLeaveAnimations[\"TILE-BUILDING\"] = {\n        keyframes: [\n          { transform: \"translate3d(0, 0, 0)\", opacity: \"1\" },\n          { transform: \"translate3d(0, 50%, 0)\", opacity: \"0\" }\n        ],\n        options: 1000\n      };\n      instance.storedEnterAnimations.MONSTER = {\n        keyframes: [\n          { transform: \"translate3d(0, 50%, 0)\", opacity: \"0\" },\n          { transform: \"translate3d(0, 0, 0)\", opacity: \"1\" }\n        ],\n        options: 300\n      };\n      instance.storedLeaveAnimations.MONSTER = {\n        keyframes: [\n          { transform: \"translate3d(0, 0, 0)\", opacity: \"1\" },\n          { transform: \"translate3d(0, 50%, 0)\", opacity: \"0\" }\n        ],\n        options: 1000\n      };\n\n      return instance;\n    });\n  }\n  if (environment.testing) {\n    aurelia.use.plugin(\"aurelia-testing\");\n  }\n\n  await aurelia.start();\n\n  const storage = rehydrateFromLocalStorage({}, LOCALSTORAGE_SAVE_KEY) as State;\n  aurelia.setRoot(storage.gameStarted ? \"./app\" : \"./start-screen\");\n}\n","@import url('https://fonts.googleapis.com/css?family=MedievalSharp&display=swap');\n@import \"../style/colors\";\n@import \"../style/helpers\";\n\n$defaultFont: 'MedievalSharp', cursive;\n\n.body {  \n  background-color: $body-bg;\n  font-family: $defaultFont;\n  margin: 0;\n  -webkit-tap-highlight-color: rgba(0, 0, 0, 0);\n  user-select: none;\n}\n\n// stylelint-disable-next-line\nux-dialog-overlay.active {\n  background-color: $dialog-overlay-bg;\n  opacity: 0.5;\n}\n\n@import \"./app\";\n@import \"./start-screen\";\n@import \"./board/index\";\n@import \"./player/player\";\n@import \"./sidebar/index\";\n@import \"./buildings/index\";\n@import \"./monster/index\";\n","/* stylelint-disable */\n$graphite: #2A2708;\n$stonewall: #928573;\n$beaver: #896552;\n$gold: #FFD700;\n$iron: #D4D7D9;\n$charcoal: #36454F;\n$blood: #8a0303;\n$eastbay: #3C4777;\n$cod-gray: #0f0f0e;\n$tuatara: #292927;\n$clover: #3D5A1B;\n\n/* General */\n$body-bg: $tuatara;\n$toggle-cbar-btn-bg: $cod-gray;\n$toggle-cbar-btn-fg: $stonewall;\n$dialog-overlay-bg: $cod-gray;\n\n/* Start screen */\n$text-fg: $iron;\n\n/* Tiles */\n$tile-bg: $cod-gray;\n$tile-border-bg: black;\n$tile-bg--wood: $graphite;\n$tile-bg--stone: $stonewall;\n$tile-bg--iron: $iron;\n$tile-bg--gold: $gold;\n$tile-bg--food: $beaver;\n$tile-bg--mana: $eastbay;\n$tile-bg--coal: $charcoal;\n$tile-bg--blood: $blood;\n$tile-bg--start: white;\n\n\n/* Fortress */\n$fortress-bg: lightgray;\n\n/* Player */\n$player-bg-border: red;\n\n/* Monster */\n$monster-stats-color: white;\n$monster-hp-bg: $clover;\n$monster-dmg-bg: black;\n$monster-stat-border: $eastbay;\n\n/* Sidebar */\n$dice-text-bg: white;\n$resources-text-fg: white;\n$save-button-bg: $eastbay;\n$save-button-border: $cod-gray;\n$save-button-text: white;\n\n/* Purchase panel */\n$purchase-panel-bg: black;\n\n/* Buildings */\n$building-radial-bg: $tuatara;\n$building-indicator-bg: black;\n/* stylelint-enable */\n",".app {\n  display: flex;\n  height: 100vh;\n  margin: 0 auto;\n  width: 100vw;\n\n  &__sidebar {\n    flex-grow: 1;\n\n    &--visible {\n      display: flex;\n    }\n\n    &--hidden {\n      display: none;\n    }\n  }\n\n  &__board {\n    flex-grow: 22;\n  }\n\n  &__toggle-sidebar {\n    background-color: $toggle-cbar-btn-bg;\n    border: none;\n    color: $toggle-cbar-btn-fg;\n\n    &::-moz-focus-inner {\n      border: 0;\n    }\n    &:focus {\n      outline: none;\n    }\n\n    @include mq-desktop {\n      display: none;\n    }\n  }\n\n  @include mq-desktop {\n    height: 50vw;\n    margin: 10px auto;\n    width: 80vw;\n  }\n}\n","@mixin mq-desktop {\n  @media (min-width: 1281px) {\n      @content;\n  }\n}\n",".start-screen {\n  align-items: center;\n  color: $text-fg;\n  display: flex;\n  flex-direction: column;\n  height: 90vh;\n  justify-content: center;\n  margin: 0 auto;\n  width: 90vw;\n\n  &__icon {\n    background-image: url(\"assets/favicon_maskable.png\");\n    background-size: contain;\n    border-radius: 15px;\n    box-shadow: 5px 3px 3px $cod-gray;\n    cursor: pointer;\n    height: 20vh;\n    min-height: 200px;\n    min-width: 200px;\n    padding-top: 15px;\n    text-align: center;\n    width: 20vh;\n  }\n\n  &__attributions {\n    margin-top: 15px;\n  }\n  \n  &__link {\n    &:visited,\n    &:active,\n    &:hover {\n      color: $text-fg;\n    }\n  }\n\n  &__name {\n    border: none;\n    font-family: $defaultFont;\n    padding: 3px 5px;\n  }\n\n  &__github {\n    cursor: pointer;\n    position: relative;\n    top: 5px;\n  }\n}\n",".tile {\n  align-items: center;\n  background-color: $tile-bg;\n  background-repeat: no-repeat;\n  display: flex;\n  flex-grow: 1;\n  justify-content: center;\n  outline: 1px solid $tile-border-bg;\n  position: relative;\n\n  &--bottom {\n    background-position: bottom center;\n    background-size: 80%;\n  }\n\n  &--top {\n    background-position: top center;\n    background-size: 80%;\n  }\n\n  &--left {\n    background-position: left center;\n  }\n\n  &--right {\n    background-position: right center;\n  }\n\n  &--wood {\n    background-image: url(\"assets/icons/forest.svg\");\n  }\n\n  &--gold {\n    background-image: url(\"assets/icons/two-coins.svg\");\n  }\n\n  &--stone {\n    background-image: url(\"assets/icons/stone-block.svg\");\n  }\n\n  &--iron {\n    background-image: url(\"assets/icons/ore.svg\");\n  }\n\n  &--food {\n    background-image: url(\"assets/icons/wheat.svg\");\n  }\n\n  &--mana {\n    background-image: url(\"assets/icons/vortex.svg\");\n  }\n\n  &--coal {\n    background-image: url(\"assets/icons/brick-pile.svg\");\n  }\n\n  &--blood {\n    background-image: url(\"assets/icons/bloody-stash.svg\");\n  }\n\n  &--start {\n    background-image: url(\"assets/icons/direction-signs.svg\");\n  }\n\n  &--rally_point {\n    background-image: url(\"assets/icons/rally-the-troops.svg\");\n  }\n\n  &--tragedy {\n    background-image: url(\"assets/icons/tear-tracks.svg\");\n  }\n\n  &--sacred_grounds {\n    background-image: url(\"assets/icons/tumulus.svg\");\n  }\n\n  &--construction-site {\n    background-image: url(\"assets/icons/hand-saw.svg\");\n  }\n\n  &--fire_fountain {\n    background-image: url(\"assets/icons/fire-ring.svg\");\n  }\n\n  &--corner {\n    background-size: initial;\n    flex-direction: column;\n    flex-grow: 2;\n    outline: 1px solid $tile-border-bg;\n    position: relative;\n  }\n\n  &__text {\n    font-size: 14px;\n    font-weight: 500;\n    left: 0;\n    line-height: 1vw;\n    position: absolute;\n    right: 0;\n    text-align: center;\n    top: 12%;\n  }\n\n  &__player {\n    top: 30%;\n  }\n}\n",".board {\n  height: 100%;\n\n  &__row {\n    display: flex;\n    width: 100%;\n\n    &--top,\n    &--bottom {\n      height: 15.384615385%;\n    }\n\n    &--bottom {\n      flex-flow: row-reverse;\n    }\n\n    &--center {\n      height: 69.23076923%;\n    }\n  }\n\n  &__col {\n    outline: 1px solid $tile-border-bg;\n    position: relative;\n\n    &--left,\n    &--right {\n      display: flex;\n      flex-direction: column;\n      flex-grow: 2;\n    }\n\n    &--left {\n      flex-flow: column-reverse;\n    }\n\n    &--center {\n      flex-basis: 0;\n      flex-grow: 9;\n    }\n  }\n\n  &__fortress {\n    outline: none;\n  }\n}\n",".tragedy {\n  align-items: center;\n  display: flex;\n  flex-direction: column;\n\n  &__image {\n    width: 150px;\n  }\n\n  &__description {\n    text-align: justify;\n    text-justify: inter-word;\n    width: 400px;\n  }\n}\n",".fortress {\n  align-items: center;\n  background-color: $fortress-bg;\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  justify-content: center;\n\n  &__caption {\n    align-items: center;\n    display: flex;\n    flex: 8;\n  }\n\n  &__buildings {\n    align-items: center;\n    display: flex;\n    height: 25%;\n    justify-content: space-evenly;\n    width: 100%;\n  }\n\n  &__building {\n    height: 60%;\n  }\n}\n",".game-over {\n  &__header {\n    margin: 0;\n  }\n\n  &__new-game {\n    margin-bottom: 15px;\n  }\n}\n",".player {\n  align-items: center;\n  background-color: $player-bg-border;\n  border: 1px solid $player-bg-border;\n  border-radius: 50%;\n  display: flex;\n  font-size: 10px;\n  height: 4vw;\n  justify-content: center;\n  position: absolute;\n  width: 4vw;\n  z-index: 1;\n}\n",".sidebar {\n  flex-direction: column;\n\n  &__item {\n    align-items: center;\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n  }\n\n  &__order-container {\n    display: flex;\n    flex-direction: row;\n    justify-content: center;\n\n    @include mq-desktop {\n      display: unset;\n      flex-direction: unset;\n      justify-content: unset;\n    }\n  }\n}\n\n.save {\n  &__button {\n    background-color: $save-button-bg;\n    border: 1px solid $save-button-border;\n    border-radius: 3px;\n    color: $save-button-text;\n    height: 30px;\n    margin: 10px 10px 0 10px;\n    width: calc(100% - 20px);\n  }\n}\n\n@import \"./dice\";\n@import \"./tragedy-overview\";\n@import \"./resources-overview\";\n@import \"./stats-overview\";\n@import \"./build-overview\";\n",".dice {\n  &__icon {\n    cursor: pointer;\n    height: 40px;\n    width: 40px;\n  }\n\n  &__round {\n    color: $resources-text-fg;\n    font-size: 1em;\n    margin: 5px 0;\n\n    @include mq-desktop {\n      font-size: 1.5em;      \n    }\n  }\n  \n  &__last-roll {\n    background-color: $dice-text-bg;\n    font-size: 20px;\n    margin-top: 5px;\n    text-align: center;\n    width: 50px;\n  }\n}\n",".tragedy-overview {\n  display: flex;\n  justify-content: center;\n\n  &__image {\n    width: 40px;\n\n    @include mq-desktop {\n      width: 100px;\n    }\n\n    &--hidden {\n      visibility: hidden;\n    }\n  }\n}\n",".resources-overview {\n  &__list {\n    color: $resources-text-fg;\n    display: flex;\n    flex-direction: column;\n    flex-wrap: wrap;\n    height: 80px;\n    list-style: none;\n    padding: 0;\n    width: 90px;\n\n    @include mq-desktop {\n      flex-wrap: unset;\n      height: unset;\n      width: 70px;\n    }\n  }\n\n  &__item {\n    align-items: center;\n    display: flex;\n    justify-content: space-between;\n    margin-right: 10px;\n\n    @include mq-desktop {\n      margin-right: unset;\n    }\n  }\n\n  &__image {\n    width: 15px;\n    @include mq-desktop {\n      width: 30px;\n    }\n  }\n}\n",".stats-overview {\n  &__list {\n    color: $resources-text-fg;\n    display: flex;\n    flex-direction: row;\n    list-style: none;\n    padding: 0;\n    width: 90px;\n\n    @include mq-desktop {\n      flex-direction: column;\n      width: 70px;\n    }\n  }\n\n  &__item {\n    align-items: center;\n    display: flex;\n    justify-content: space-between;\n    margin-right: 5px;\n\n    @include mq-desktop {\n      margin-right: unset;\n    }\n  }\n\n  &__image {\n    width: 15px;\n\n    @include mq-desktop {\n      width: 30px;\n    }\n  }\n}\n",".build-overview {\n  display: flex;\n  justify-content: center;\n\n  &__image {\n    width: 40px;\n\n    @include mq-desktop {\n      width: 100px;\n    }\n\n    &--hidden {\n      visibility: hidden;\n    }\n  }\n}\n","$topBarHeight: 1.3em;\n\n.purchase-panel {\n  &__top-bar {\n    display: flex;\n    justify-content: space-between;\n  }\n\n  &__stats-icon {\n    width: $topBarHeight;\n  }\n\n  &__list {\n    list-style: none;\n    padding: 0;\n  }\n\n  &__building-icon {\n    width: 70px;\n  }\n\n  &__building-name {\n    display: flex;\n    justify-content: center;\n  }\n\n  &__button {\n    margin-top: 10px;\n  }\n\n  &__cost {\n    list-style: none;\n    padding: 0 0 0 5px;\n  }\n\n  &__close {\n    margin-bottom: 15px;\n  }\n\n  &__header {\n    font-size: $topBarHeight;\n    margin: 0;\n  }\n}\n\n.cost {\n  &__item {\n    align-items: center;\n    display: flex;\n    justify-content: space-between;\n  }\n\n  &__icon {\n    width: 30px;\n  }\n}\n",".tile-building {\n  display: flex;\n  height: 100%;\n  width: 100%;\n\n  &--bottom {\n    justify-content: center;\n  }\n\n  &--top {\n    align-items: flex-end;\n    justify-content: center;\n  }\n\n  &--left {\n    align-items: center;\n    justify-content: flex-end;\n  }\n\n  &--right {\n    align-items: center;\n    justify-content: flex-start;\n  }\n\n  &__display {\n    background-repeat: no-repeat;\n\n    &--sawmill {\n      background-image: url(\"assets/icons/crosscut-saw.svg\");\n    }\n\n    &--iron_mine {\n      background-image: url(\"assets/icons/mining.svg\");\n    }\n\n    &--farm {\n      background-image: url(\"assets/icons/windmill.svg\");\n    }\n\n    &--quarry {\n      background-image: url(\"assets/icons/stone-crafting.svg\");\n    }\n\n    &--gold_mine {\n      background-image: url(\"assets/icons/gold-mine.svg\");\n    }\n\n    &--mana_rift {\n      background-image: url(\"assets/icons/magic-portal.svg\");\n    }\n\n    &--coal_mine {\n      background-image: url(\"assets/icons/coal-wagon.svg\");\n    }\n\n    &--butchery {\n      background-image: url(\"assets/icons/meat-cleaver.svg\");\n    }\n\n    &--shrine {\n      background-image: url(\"assets/icons/fire-shrine.svg\");\n    }\n\n    &--bottom {\n      margin-top: 10%;\n      width: 45%;\n    }\n\n    &--top {\n      height: 30%;\n      margin-bottom: 10%;\n      width: 45%;\n    }\n\n    &--left {\n      height: 60%;\n      margin-right: 5%;\n      width: 27%;\n    }\n\n    &--right {\n      height: 60%;\n      margin-left: 5%;\n      width: 27%;\n    }\n  }\n}\n",".construction-panel {\n  &__list {\n    list-style: none;\n    padding: 0;\n  }\n\n  &__message {\n    margin: 10px 0;\n  }\n\n  &__building-icon {\n    margin: 0 10px;\n    width: 70px;\n  }\n\n  &__building-navigator {\n    height: 30px;\n  }\n\n  &__building-name {\n    align-items: center;\n    display: flex;\n    justify-content: center;\n  }\n\n  &__buy {\n    margin-top: 10px;\n  }\n\n  &__cost {\n    list-style: none;\n    padding: 0 0 0 5px;\n  }\n\n  &__close {\n    margin-bottom: 15px;\n  }\n\n  &__header {\n    margin: 0;\n  }\n}\n",".fortress-building {\n  &__icon {\n    height: 100%;\n  }\n}\n",".monster {\n  align-items: center;\n  display: flex;\n  justify-content: center;\n  position: absolute;\n  z-index: 1;\n\n  &:hover {\n    z-index: 2;\n  }\n\n  // stylelint-disable selector-max-specificity\n  &:only-of-type {\n    // stylelint-disable-next-line declaration-no-important\n    left: initial!important;\n  }\n  @for $i from 1 through 4 {\n    &:nth-child(#{$i}) {\n      left: #{($i - 1) * 15}px;\n    }\n  }\n  // stylelint-enable\n\n  &__icon {\n    height: 4vw;\n    width: 4vw;\n  }\n\n  &__stats-container {\n    color: $monster-stats-color;\n    position: absolute;\n    top: 73%;\n    width: 100%;\n  }\n\n  &__stat {\n    border: 2px solid $monster-stat-border;\n    border-radius: 30%;\n    font-size: 1.2vh;\n    height: 2vh;\n    line-height: 2vh;\n    text-align: center;\n    width: 2vh;\n\n    &--hp {\n      background-color: $monster-hp-bg;\n      float: left;\n    }\n\n    &--dmg {\n      background-color: $monster-dmg-bg;\n      float: right;\n    }\n  }\n}\n","import { FrameworkConfiguration } from \"aurelia-framework\";\n\nimport { Monster } from \"./monster\";\n\nexport function configure(config: FrameworkConfiguration) {\n  config.globalResources([\n    Monster\n  ]);\n}\n","import { bindable, computedFrom } from \"aurelia-framework\";\n\nexport class Monster {\n  @bindable public currentTileId: string;\n  @bindable public type: MonsterType;\n  @bindable public stats: MonsterStats;\n\n  @computedFrom(\"type\")\n  public get icon(): string {\n    return MonsterPropMap[this.type].icon;\n  }\n}\n\nexport const AllMonsters = [\n  \"Zombie\",\n  \"Skeleton\",\n  \"Golem\",\n  \"Dragon\"\n] as const;\n\nexport type MonsterType = (typeof AllMonsters)[number];\n\nexport const MonsterPropMap: { [monster in MonsterType]: { icon: string, stats: MonsterStats } } = {\n  Dragon: {\n    icon: \"spiked-dragon-head\",\n    stats: { hp: 30, dmg: 10 }\n  },\n  Golem: {\n    icon: \"rock-golem\",\n    stats: { hp: 35, dmg: 5 }\n  },\n  Skeleton: {\n    icon: \"harry-potter-skull\",\n    stats: { hp: 13, dmg: 4 }\n  },\n  Zombie: {\n    icon: \"half-body-crawling\",\n    stats: { hp: 10, dmg: 2 }\n  },\n};\n\nexport interface MonsterStats {\n  hp: number;\n  dmg: number;\n}\n","<template class=\"monster au-animate\">\n  <img title.bind=\"type\"\n       alt.bind=\"type\"\n       class=\"monster__icon\"\n       src=\"assets/icons/monsters/${icon}.svg\" />\n  <div class=\"monster__stats-container\">\n    <span class=\"monster__stat monster__stat--hp\"\n          title=\"Health\">${stats.hp}</span>\n    <span class=\"monster__stat monster__stat--dmg\"\n          title=\"Damage\">${stats.dmg}</span>\n  </div>\n</template>\n","import { FrameworkConfiguration } from \"aurelia-framework\";\n\nimport { Player } from \"./player\";\n\nexport function configure(config: FrameworkConfiguration) {\n  config.globalResources([\n    Player\n  ]);\n}\n","import { bindable } from \"aurelia-framework\";\n\nexport class Player {\n  @bindable public currentTileId: string;\n  @bindable public name: string;\n}\n","<template class=\"player\" data-aid=\"player\">\n  ${name}\n</template>\n","import { TileType } from \"../board/tile\";\n\nexport type ResourceTileType = Exclude<TileType, \"start\" | \"rally_point\" | \"tragedy\" | \"sacred_grounds\" | \"construction-site\" | \"fire_fountain\">;\nexport type Resources = {\n  [key in ResourceTileType]: number;\n};\nexport const ResourcesIcons: {\n  [key in ResourceTileType]: string;\n} = {\n  blood: \"bloody-stash\",\n  coal: \"brick-pile\",\n  food: \"wheat\",\n  gold: \"two-coins\",\n  iron: \"ore\",\n  mana: \"vortex\",\n  stone: \"stone-block\",\n  wood: \"forest\"\n};\n\nexport type Stat = \"defense\" | \"population\" | \"soldiers\";\nexport type Stats = {\n  [key in Stat]: number;\n};\nexport const StatsIcons: {\n  [key in Stat]: string;\n} = {\n  defense: \"checked-shield\",\n  population: \"icicles-aura\",\n  soldiers: \"sword-brandish\"\n};\n","import { computedFrom } from \"aurelia-framework\";\nimport { connectTo } from \"aurelia-store\";\n\nimport { FortressBuilding } from \"../buildings/fortress-building\";\nimport { State } from \"../store/state\";\n\n@connectTo()\nexport class BuildOverview {\n  public state: State;\n\n  @computedFrom(\"state.activeFortressBuildingConstruction\")\n  public get building(): FortressBuilding {\n    const currBuilding = this.state && this.state\n      .fortressBuildings\n      .find((fb) => fb.type === this.state.activeFortressBuildingConstruction);\n\n    if (currBuilding) {\n      return Object.assign(new FortressBuilding(), currBuilding);\n    }\n  }\n}\n","<template class=\"build-overview\">\n  <img src=\"assets/icons/${building.icon ||'empty'}.svg\"\n       title.bind=\"building.name\"\n       alt.bind=\"building.name\"\n       class=\"${bem('build-overview', 'image', !state.activeFortressBuildingConstruction && 'hidden')}\">\n</template>\n","import { EventAggregator, Subscription } from \"aurelia-event-aggregator\";\nimport { autoinject } from \"aurelia-framework\";\nimport { connectTo, Store } from \"aurelia-store\";\nimport { map } from \"rxjs/operators\";\n\nimport { WebAnimationAnimator } from \"../animator/animator\";\nimport { rollDice, State } from \"../store/index\";\n\n@autoinject()\n@connectTo((state: Store<State>) => state.state.pipe(\n  map((value) => ({ lastDiceRoll: value.lastDiceRoll, round: value.round }))\n))\nexport class Dice {\n  private keyShortcutSubscription: Subscription;\n\n  constructor(\n    private store: Store<State>,\n    private animator: WebAnimationAnimator,\n    private ea: EventAggregator\n  ) {\n    this.keyShortcutSubscription = this.ea.subscribe(\"key-shortcut\", () => this.rollDice());\n  }\n\n  public detach() {\n    this.keyShortcutSubscription.dispose();\n  }\n\n  public async rollDice() {\n    const playerOldRect = document.querySelector(\"player\").getBoundingClientRect();\n    await this.store.dispatch(rollDice);\n\n    const playerNewPos = document.querySelector(\"player\");\n    const playerNewCompStyle = window.getComputedStyle(playerNewPos);\n    const playerNewBoundingRect = playerNewPos.getBoundingClientRect();\n    const topAdjust = parseInt(playerNewCompStyle.top.replace(\"px\", \"\"), 10);\n    const leftAdjust = parseInt(playerNewCompStyle.left.replace(\"px\", \"\"), 10);\n\n    await this.animator.animate(playerNewPos, {\n      left: [\n        `${Math.ceil(playerOldRect.x - playerNewBoundingRect.x + leftAdjust)}px`,\n       playerNewCompStyle.left\n      ],\n      top: [\n        `${Math.ceil(playerOldRect.y - playerNewBoundingRect.y + topAdjust)}px`,\n        playerNewCompStyle.top\n      ],\n    }, 150);\n  }\n}\n","<template class=\"dice\"\n          title=\"Roll the dice\">\n  <h2 class=\"dice__round\" data-aid=\"current-round\">Round ${state.round}</h2>\n  <img src=\"assets/icons/dice.svg\"\n       click.trigger=\"rollDice()\"\n       alt=\"A dice ready to roll\"\n       class=\"dice__icon\"\n       data-aid=\"btn-dice-roll\" />\n\n  <span class=\"dice__last-roll\">${state.lastDiceRoll ||'none'}</span>\n</template>\n","import { FrameworkConfiguration } from \"aurelia-framework\";\n\nimport { BuildOverview } from \"./build-overview\";\nimport { Dice } from \"./dice\";\nimport { ResourcesOverview } from \"./resources-overview\";\nimport { Save } from \"./save\";\nimport { Sidebar } from \"./sidebar\";\nimport { StatsOverview } from \"./stats-overview\";\nimport { TragedyOverview } from \"./tragedy-overview\";\n\nexport function configure(config: FrameworkConfiguration) {\n  config.globalResources([\n    Sidebar,\n    BuildOverview,\n    Dice,\n    ResourcesOverview,\n    StatsOverview,\n    Save,\n    TragedyOverview\n  ]);\n}\n","import { computedFrom } from \"aurelia-framework\";\nimport { connectTo } from \"aurelia-store\";\nimport { upperFirst } from \"lodash\";\nimport { pluck } from \"rxjs/operators\";\n\nimport { Resources, ResourcesIcons } from \"../resources/index\";\n\n@connectTo((store) => store.state.pipe(pluck(\"resources\")))\nexport class ResourcesOverview {\n  public state: Resources;\n\n  @computedFrom(\"state\")\n  public get resources() {\n    if (!this.state) {\n      return [];\n    }\n\n    return Object.entries(this.state)\n      .map((e) => ({\n        icon: ResourcesIcons[e[0]],\n        name: upperFirst(e[0]),\n        value: e[1],\n      }));\n  }\n}\n","<template class=\"resources-overview\">\n  <ul class=\"resources-overview__list\">\n    <li class=\"resources-overview__item\"\n        repeat.for=\"res of resources\">\n      <img title.bind=\"res.name\"\n           alt.bind=\"res.name\"\n           class=\"resources-overview__image\"\n           src=\"assets/icons/${res.icon}.svg\" />\n      <span class=\"resources-overview__value\">${res.value}</span>\n    </li>\n  </ul>\n</template>\n","import { autoinject } from \"aurelia-framework\";\nimport { Store } from \"aurelia-store\";\n\nimport { initialState, LOCALSTORAGE_SAVE_KEY, State } from \"../store/state\";\n\n@autoinject()\nexport class Save {\n\n  constructor(private store: Store<State>) { }\n\n  public newGame() {\n    this.store.resetToState(initialState);\n    window.localStorage.removeItem(LOCALSTORAGE_SAVE_KEY);\n    window.location.reload();\n  }\n\n  public saveGame() {\n    const data = new Blob([window.localStorage.getItem(LOCALSTORAGE_SAVE_KEY) || JSON.stringify(initialState)], { type: \"application/json\" });\n    const url = window.URL.createObjectURL(data);\n    const anchor = document.createElement(\"a\");\n    anchor.href = url;\n    anchor.target = \"_blank\";\n    anchor.download = \"enforted-save.json\";\n    anchor.click();\n\n    window.URL.revokeObjectURL(url);\n  }\n}\n","<template class=\"save\">\n    <button class=\"save__button save__button--to-file\"\n            click.trigger=\"saveGame()\">Save game</button>\n    <button class=\"save__button save__button--new-game\"\n            click.trigger=\"newGame()\">New game</button>\n</template>\n","export class Sidebar {\n}\n","<template class=\"sidebar\">\n  <dice class=\"sidebar__item\"></dice>\n  <resources-overview class=\"sidebar__item\"></resources-overview>\n  <stats-overview class=\"sidebar__item\"></stats-overview>\n  <div class=\"sidebar__order-container\">\n    <tragedy-overview></tragedy-overview>\n    <build-overview></build-overview>\n  </div>\n  <save class=\"sidebar__item\"></save>\n</template>\n","import { computedFrom } from \"aurelia-framework\";\nimport { connectTo } from \"aurelia-store\";\nimport { upperFirst } from \"lodash\";\nimport { pluck } from \"rxjs/operators\";\n\nimport { Stats, StatsIcons } from \"../resources/index\";\n\n@connectTo((store) => store.state.pipe(pluck(\"stats\")))\nexport class StatsOverview {\n  public state: Stats;\n\n  @computedFrom(\"state\")\n  public get stats() {\n    if (!this.state) {\n      return [];\n    }\n\n    return Object.entries(this.state)\n      .map((e) => ({\n        icon: StatsIcons[e[0]],\n        name: upperFirst(e[0]),\n        value: e[1],\n      }));\n  }\n}\n","<template class=\"stats-overview\">\n  <ul class=\"stats-overview__list\">\n    <li class=\"stats-overview__item\"\n        repeat.for=\"res of stats\">\n      <img title.bind=\"res.name\"\n           alt.bind=\"res.name\"\n           class=\"stats-overview__image\"\n           src=\"assets/icons/${res.icon}.svg\" />\n      <span class=\"stats-overview__value\">${res.value}</span>\n    </li>\n  </ul>\n</template>\n","import { computedFrom } from \"aurelia-framework\";\nimport { connectTo } from \"aurelia-store\";\nimport { pluck } from \"rxjs/operators\";\n\nimport { AvailableTragedyEvents, tragedyEvents } from \"../board/tragedy\";\n\n@connectTo((store) => store.state.pipe(pluck(\"activeTragedy\")))\nexport class TragedyOverview {\n  public state: AvailableTragedyEvents;\n\n  @computedFrom(\"state\")\n  public get tragedy() {\n    return tragedyEvents.find((te) => te.event === this.state);\n  }\n}\n","<template class=\"tragedy-overview\">\n  <img src=\"assets/icons/${tragedy.image ||'empty'}.svg\"\n       title.bind=\"tragedy.name\"\n       alt.bind=\"tragedy.name\"\n       class=\"${bem('tragedy-overview', 'image', !tragedy && 'hidden')}\">\n</template>\n","import createAuth0Client from \"@auth0/auth0-spa-js\";\nimport { Aurelia, autoinject } from \"aurelia-framework\";\nimport { Store } from \"aurelia-store\";\n\nimport { addPlayer } from \"./store/actions/commands\";\nimport { State } from \"./store/state\";\n\n@autoinject()\nexport class StartScreen {\n  public playerName: string = \"\";\n\n  constructor(\n    private store: Store<State>,\n    private au: Aurelia\n  ) {\n    this.store.registerAction(\"Start game\", startGame);\n    this.store.registerAction(\"Add a player\", addPlayer);\n  }\n\n  public async loginWithGithub() {\n    const auth0 = await createAuth0Client({\n      client_id: \"wtxHvxLecRBpapZwvSXMMmZsZ8fEEEzI\",\n      domain: \"enforted.eu.auth0.com\",\n    });\n\n    await auth0.loginWithPopup();\n    const user = await auth0.getUser();\n\n    this.start(user.nickname);\n  }\n\n  public startGame($event?: MouseEvent) {\n    if (($event?.target as HTMLElement).tagName === \"INPUT\" || !this.playerName || this.playerName.trim() === \"\") {\n      return false;\n    }\n\n    this.start(this.playerName);\n  }\n\n  private start(name: string) {\n    this.store.pipe(addPlayer, name).pipe(startGame).dispatch();\n    this.au.setRoot(\"./app\");\n  }\n}\n\nexport function startGame(state: State): State {\n  return {\n    ...state,\n    gameStarted: true\n  };\n}\n","<template>\n  <require from=\"./main.css\"></require>\n\n  <div class=\"start-screen\">\n    <h1 class=\"start-screen__title\"><a class=\"start-screen__link\"\n         href=\"https://github.com/zewa666/enforted\">Enforted</a> - A board game made with Aurelia</h1>\n    <div class=\"start-screen__icon\"\n         data-aid=\"btn-start-game\"\n         click.trigger=\"startGame($event)\">Start your journey\n      <input class=\"start-screen__name\"\n             value.bind=\"playerName\"\n             data-aid=\"input-player-name\"\n             placeholder=\"Enter your name\" />\n    </div>\n    <div class=\"start-screen__oauth\">\n      or login with\n      <img src=\"assets/github-logo.png\"\n           class=\"start-screen__github\"\n           click.trigger=\"loginWithGithub()\" />\n    </div>\n\n    <p class=\"start-screen__attributions\">All icons from <a class=\"start-screen__link\"\n         href=\"https://game-icons.net/\">game-icons.net</a>, for details see the\n      <a class=\"start-screen__link\"\n         href=\"../assets/icons/attribution.json\"\n         target=\"_blank\"> attributions file</a>\n    </p>\n  </div>\n</template>\n","import { Tile } from \"../../board/tile\";\nimport { AvailableTragedyEvents } from \"../../board/tragedy\";\nimport {\n  AvailableFortressBuildings,\n  FortressBuilding,\n  FortressBuildingResourceCost\n} from \"../../buildings/fortress-building\";\nimport { TileBuilding, TileBuildingResourceCost } from \"../../buildings/tile-building\";\nimport { State } from \"../index\";\n\nexport function openPurchaseForTile(state: State, tile: Tile): State {\n  return {\n    ...state,\n    purchaseInProgress: tile.id\n  };\n}\n\nexport function closePurchasePanel(state: State) {\n  return {\n    ...state,\n    purchaseInProgress: undefined\n  };\n}\n\nexport function buyBuilding(state: State, building: TileBuilding): State {\n  const costs = TileBuildingResourceCost[building.type];\n\n  return {\n    ...state,\n    purchaseInProgress: undefined,\n    resources: {\n      blood: state.resources.blood - costs.blood,\n      coal: state.resources.coal - costs.coal,\n      food: state.resources.food - costs.food,\n      gold: state.resources.gold - costs.gold,\n      iron: state.resources.iron - costs.iron,\n      mana: state.resources.mana - costs.mana,\n      stone: state.resources.stone - costs.stone,\n      wood: state.resources.wood - costs.wood,\n    },\n    tileBuildings: [\n      ...state.tileBuildings, building\n    ]\n  };\n}\n\nexport function destroyBuilding(\n  state: State,\n  tileId: string\n): State {\n  const idx = state.tileBuildings.findIndex((tb) => tb.tileId === tileId);\n\n  return {\n    ...state,\n    tileBuildings: [\n      ...state.tileBuildings.slice(0, idx),\n      ...state.tileBuildings.slice(idx + 1),\n    ]\n  };\n}\n\nexport function reinforceTileBuilding(state: State, tileId: string): State {\n  const idx = state.tileBuildings.findIndex((tb) => tb.tileId === tileId);\n\n  return {\n    ...state,\n    stats: {\n      ...state.stats, soldiers: state.stats.soldiers - 1\n    },\n    tileBuildings: [\n      ...state.tileBuildings.slice(0, idx),\n      {\n        ...state.tileBuildings[idx],\n        garrison: state.tileBuildings[idx].garrison + 1\n      } as TileBuilding,\n      ...state.tileBuildings.slice(idx + 1),\n    ]\n  };\n}\n\nexport function buyFortressBuilding(state: State, type: AvailableFortressBuildings): State | false {\n  const costs = FortressBuildingResourceCost[type];\n\n  if (state.activeFortressBuildingConstruction) {\n    return false;\n  }\n\n  return {\n    ...state,\n    activeFortressBuildingConstruction: type,\n    fortressBuildings: [\n      ...state.fortressBuildings, { type } as FortressBuilding\n    ],\n    resources: {\n      blood: state.resources.blood - costs.blood,\n      coal: state.resources.coal - costs.coal,\n      food: state.resources.food - costs.food,\n      gold: state.resources.gold - costs.gold,\n      iron: state.resources.iron - costs.iron,\n      mana: state.resources.mana - costs.mana,\n      stone: state.resources.stone - costs.stone,\n      wood: state.resources.wood - costs.wood,\n    },\n    stats: {\n      ...state.stats,\n      defense: type === \"palisades\" ? state.stats.defense + 10 : state.stats.defense\n    }\n  } as State;\n}\n\nexport function addPlayer(state: State, name: string): State {\n  return {\n    ...state,\n    players: [{\n      currentTileId: state.tiles[0].id,\n      name\n    }]\n  };\n}\n","import { AvailableTragedyEvents } from \"../../board/tragedy\";\nimport { AvailableTileBuildings } from \"../../buildings/tile-building\";\nimport { Player } from \"../../player/player\";\nimport { Resources } from \"../../resources/index\";\nimport { randBetween } from \"../helper\";\nimport { State } from \"../index\";\nimport { generateWave, monsterRoll } from \"./monsters\";\n\nexport function rollDice(state: State, diceOverload?: number): State {\n  const isStumblingStep = state.activeTragedy === AvailableTragedyEvents.StumblingSteps;\n  const idxOfTile = state.tiles.findIndex((t) => t.id === state.players[0].currentTileId);\n  const roll = diceOverload || (isStumblingStep ? 1 : randBetween(1, 6));\n  const newPosition = idxOfTile + roll;\n  const isNextRound = newPosition > state.tiles.length - 1;\n  const newStumblingSteps = (state.activeTragedyParams === undefined || state.activeTragedyParams[0] === 1)\n    ? undefined\n    : [state.activeTragedyParams[0] - 1];\n  const monsterRollState = monsterRoll(state, diceOverload);\n\n  return gatherFortressBuilding({\n    ...state,\n    activeFortressBuildingConstruction: isNextRound ? undefined : state.activeFortressBuildingConstruction,\n    activeTragedy: isNextRound\n      ? undefined\n      : isStumblingStep && newStumblingSteps === undefined\n        ? undefined\n        : state.activeTragedy,\n    activeTragedyParams: isNextRound\n      ? undefined\n      : isStumblingStep\n        ? newStumblingSteps\n        : state.activeTragedyParams,\n    lastDiceRoll: roll,\n    monsters: generateWave(monsterRollState, isNextRound).monsters,\n    players: [\n      {\n        ...state.players[0],\n        currentTileId: newPosition > state.tiles.length - 1\n          ? state.tiles[Math.abs(newPosition - state.tiles.length)].id\n          : state.tiles[newPosition].id\n      } as Player\n    ],\n    purchaseInProgress: undefined,\n    resources: isNextRound\n      ? gatherResources(state).resources\n      : state.resources,\n    round: isNextRound\n      ? state.round + 1\n      : state.round,\n    stats: monsterRollState.stats,\n  }, isNextRound);\n}\n\nexport function gatherFortressBuilding(state: State, isNextRound: boolean): State {\n  if (!isNextRound) {\n    return state;\n  }\n\n  const newState = {\n    ...state,\n    resources: { ...state.resources },\n    stats: { ...state.stats }\n  } as State;\n\n  return newState.fortressBuildings.reduce((prev, curr) => {\n    switch (curr.type) {\n      case \"bakery\":\n        const res = prev.resources.coal > 0 && \"coal\" || prev.resources.wood > 0 && \"wood\";\n\n        if (res) {\n          prev.resources[res] -= 1;\n          prev.stats.population += 1;\n        }\n      case \"blacksmith_shop\":\n        if (\n          prev.resources.iron > 0 &&\n          prev.resources.coal > 0\n        ) {\n          prev.resources.iron -= 1;\n          prev.resources.coal -= 1;\n          prev.stats.soldiers += 1;\n        }\n      case \"bank\":\n        if (prev.resources.gold > 0) {\n          prev.resources.gold += 1;\n        }\n      case \"magician_tower\":\n        if (prev.resources.mana > 2) {\n          prev.resources.mana -= 3;\n          prev.fireFountainsActive = true;\n        } else {\n          prev.fireFountainsActive = false;\n        }\n    }\n\n    return prev;\n  }, newState);\n}\n\nexport const PRODUCED_RESOURCES_PER_ROUND = 3;\nexport function gatherResources(state: State): State {\n  const shrines = state.tileBuildings\n    .filter((b) => b.type === \"shrine\");\n  const resourcesProduced = PRODUCED_RESOURCES_PER_ROUND\n    + (shrines.length === 4\n      ? 1\n      : 0);\n  const resources = state.tileBuildings\n    .filter((b) => b.type !== \"shrine\")\n    .filter((b) => {\n      switch (state.activeTragedy) {\n        case AvailableTragedyEvents.BurningTrees:\n          return b.type !== \"sawmill\";\n        case AvailableTragedyEvents.ContaminatedBlood:\n          return b.type !== \"butchery\";\n        case AvailableTragedyEvents.Rockfall:\n          return b.type !== \"quarry\";\n        case AvailableTragedyEvents.ShatteringEarth:\n          return b.type !== \"mana_rift\";\n        case AvailableTragedyEvents.Vermins:\n          return b.type !== \"farm\";\n        case AvailableTragedyEvents.CollapsedMines:\n          const mineType = state.activeTragedyParams[0] as AvailableTileBuildings;\n          return b.type !== mineType;\n        default:\n          return true;\n      }\n    })\n    .reduce((prev, curr) => {\n      prev[state.tiles\n        .find((t) => t.id === curr.tileId)\n        .type] += resourcesProduced;\n      return prev;\n    }, Object.assign({}, state.resources) as Resources);\n  return gatherShrineResources({\n    ...state,\n    resources\n  });\n}\n\nexport function gatherShrineResources(state: State) {\n  const shrines = state.tileBuildings\n    .filter((b) => b.type === \"shrine\");\n  if (!shrines) {\n    return state;\n  }\n  return {\n    ...state,\n    resources: {\n      ...state.resources,\n      blood: shrines.length > 2 ? state.resources.blood + 1 : state.resources.blood,\n      gold: shrines.length > 0 ? state.resources.gold + 1 : state.resources.gold,\n      mana: shrines.length > 1 ? state.resources.mana + 1 : state.resources.mana,\n    }\n  };\n}\n","import { calculateDmg } from \"../../buildings/tile-building\";\nimport { Monster, MonsterPropMap, MonsterType } from \"../../monster/monster\";\nimport { randBetween } from \"../helper\";\nimport { State } from \"../state\";\n\nexport function monsterRoll(state: State, diceOverload?: number): State {\n  let kills = 0;\n  const monsters = state.monsters.map((m) => {\n    const idxOfTile = state.tiles.findIndex((t) => t.id === m.currentTileId);\n    const roll = diceOverload || randBetween(1, 6);\n    const newPosition = (idxOfTile + roll) > state.tiles.length - 1\n      ? state.tiles.length - 1\n      : idxOfTile + roll;\n    const nextId = newPosition > state.tiles.length - 1\n      ? state.tiles[state.tiles.length - 1].id\n      : state.tiles[newPosition].id;\n    const tileBuilding = state.tileBuildings.find((tb) => tb.tileId === nextId);\n    let newHp = tileBuilding ? m.stats.hp - calculateDmg(tileBuilding.garrison) : m.stats.hp;\n\n    // if the monster is waiting at the gates of the fortress\n    if (idxOfTile === state.tiles.length - 1) {\n      const { defense, soldiers } = state.stats;\n      const attackChance = Math.floor((100 - defense) / Math.ceil(roll / 2));\n      const monsterAttackSuccess = randBetween(1, 100) <= attackChance;\n      const effectiveMonsterDmg = m.stats.dmg - soldiers;\n\n      if (!monsterAttackSuccess) {\n        newHp -= effectiveMonsterDmg < 0\n          ? Math.abs(effectiveMonsterDmg)\n          : 2;\n      } else if (monsterAttackSuccess && effectiveMonsterDmg > 0) {\n        kills += 1;\n      }\n    }\n\n    if (\n      newHp <= 0 ||\n      (\n        state.tiles[newPosition].type === \"fire_fountain\" &&\n        state.fireFountainsActive === true\n      )\n    ) {\n      return undefined;\n    }\n\n    return {\n      ...m,\n      currentTileId: nextId,\n      stats: {\n        ...m.stats,\n        hp: newHp\n      },\n    } as Monster;\n  }).filter((m) => m);\n\n  return {\n    ...state,\n    monsters,\n    stats: {\n      ...state.stats,\n      population: state.stats.population - kills\n    }\n  };\n}\n\nexport function generateWave(state: State, isNextRound: boolean): State {\n  if (!isNextRound || !wavesAtRounds.hasOwnProperty(state.round + 1)) {\n    return state;\n  }\n\n  const newMonsters = wavesAtRounds[state.round + 1].map((type) => ({\n    currentTileId: state.tiles[0].id,\n    stats: { ...MonsterPropMap[type].stats },\n    type\n  } as Monster));\n\n  return {\n    ...state,\n    monsters: [...state.monsters, ...newMonsters]\n  };\n}\n\nexport const wavesAtRounds: {\n  [round: number]: MonsterType[]\n} = {\n  15: [...new Array(2).fill(\"Zombie\")],\n  25: [...new Array(2).fill(\"Zombie\"), \"Skeleton\"],\n  32: [...new Array(3).fill(\"Skeleton\")],\n};\n","import { AvailableTragedyEvents } from \"../../board/tragedy\";\nimport { AvailableTileBuildings } from \"../../buildings/tile-building\";\nimport { Player } from \"../../player/player\";\nimport { ResourceTileType } from \"../../resources/index\";\nimport { randBetween } from \"../helper\";\nimport { State } from \"../state\";\nimport { destroyBuilding } from \"./commands\";\n\nexport function sacrificeResources(\n  state: State,\n  resourceType: ResourceTileType,\n  byAmount: number\n): State {\n  return {\n    ...state,\n    activeTragedy: AvailableTragedyEvents.Sacrifice,\n    resources: {\n      ...state.resources,\n      [resourceType]: Math.max(0, state.resources[resourceType] - byAmount)\n    }\n  };\n}\n\nexport function ragingFire(\n  state: State,\n  tileId: string\n): State {\n  const newState = destroyBuilding(state, tileId);\n  newState.activeTragedy = AvailableTragedyEvents.RagingFire;\n\n  return newState;\n}\n\nexport function forgottenEquipment(state: State): State {\n  return {\n    ...state,\n    activeTragedy: undefined,\n    activeTragedyParams: undefined,\n    fireFountainsActive: false,\n    players: [\n      {\n        ...state.players[0],\n        currentTileId: state.tiles.find((t) => t.type === \"start\").id\n      } as Player\n    ]\n  };\n}\n\nexport function defiledAltar(state: State): State {\n  const shrines = state.tileBuildings.filter((tb) => tb.type === \"shrine\");\n  const idx = randBetween(0, shrines.length - 1);\n\n  return {\n    ...state,\n    activeTragedy: AvailableTragedyEvents.DefiledAltar,\n    tileBuildings: [\n      ...state.tileBuildings.filter((tb) => tb.tileId !== shrines[idx].tileId),\n    ]\n  };\n}\n\nexport function pausedResourceProduction(\n  state: State,\n  tragedy: AvailableTragedyEvents\n): State {\n  return {\n    ...state,\n    activeTragedy: tragedy\n  };\n}\n\nexport function collapsedMines(state: State, mineType: AvailableTileBuildings): State {\n  return {\n    ...state,\n    activeTragedy: AvailableTragedyEvents.CollapsedMines,\n    activeTragedyParams: [mineType]\n  };\n}\n\nexport function stumblingSteps(state: State): State {\n  return {\n    ...state,\n    activeTragedy: AvailableTragedyEvents.StumblingSteps,\n    activeTragedyParams: [3]\n  };\n}\n","export function guid(): string {\n  function s4() {\n    return Math.floor((1 + Math.random()) * 0x10000)\n      .toString(16)\n      .substring(1);\n  }\n  return s4() + s4() + \"-\" + s4() + \"-\" + s4() + \"-\" +\n    s4() + \"-\" + s4() + s4() + s4();\n}\n\nexport function randBetween(min: number, max: number): number {\n  return Math.floor(Math.random() * max) + min;\n}\n","export * from \"./state\";\nexport * from \"./actions/commands\";\nexport * from \"./actions/dice-roll\";\n","import { Tile } from \"../board/tile\";\nimport { AvailableTragedyEvents } from \"../board/tragedy\";\nimport { AvailableFortressBuildings, FortressBuilding } from \"../buildings/fortress-building\";\nimport { TileBuilding } from \"../buildings/tile-building\";\nimport { Monster } from \"../monster/monster\";\nimport { Player } from \"../player/player\";\nimport { Resources, Stats } from \"../resources/index\";\nimport { guid } from \"./helper\";\n\nexport const LOCALSTORAGE_SAVE_KEY = \"enforted-save-game\";\nexport interface State {\n  tiles: Tile[];\n  players: Player[];\n  monsters: Monster[];\n  fortressBuildings: FortressBuilding[];\n  tileBuildings: TileBuilding[];\n  lastDiceRoll?: number;\n  resources: Resources;\n  round: number;\n  stats: Stats;\n  activeFortressBuildingConstruction?: AvailableFortressBuildings;\n  activeTragedy?: AvailableTragedyEvents;\n  activeTragedyParams?: any[];\n  /**\n   * Setting this to undefined closes the purchase panel\n   */\n  purchaseInProgress?: string;\n  fireFountainsActive: boolean;\n  gameStarted: boolean;\n}\n\nexport const initialState = {\n  fireFountainsActive: false,\n  fortressBuildings: [],\n  gameStarted: false,\n  lastDiceRoll: undefined,\n  monsters: [],\n  players: [],\n  resources: {\n    blood: 0,\n    coal: 0,\n    food: 15,\n    gold: 30,\n    iron: 0,\n    mana: 0,\n    stone: 0,\n    wood: 20,\n  },\n  round: 1,\n  stats: {\n    defense: 0,\n    population: 10,\n    soldiers: 0\n  },\n  tileBuildings: [],\n  tiles: [\n    {\n      id: guid(),\n      isCorner: true,\n      placement: \"bottom\",\n      ring: \"outer\",\n      type: \"start\"\n    },\n    ...Array.from<Tile, Partial<Tile>>(Array(9), (_, idx) => ({\n      id: guid(),\n      isCorner: false,\n      placement: \"bottom\",\n      ring: \"outer\",\n      type: \"wood\",\n    })),\n    {\n      id: guid(),\n      isCorner: true,\n      placement: \"bottom\",\n      ring: \"outer\",\n      type: \"sacred_grounds\"\n    },\n    ...Array.from<Tile, Partial<Tile>>(Array(9), () => ({\n      id: guid(),\n      isCorner: false,\n      placement: \"left\",\n      ring: \"outer\",\n      type: \"food\",\n    })),\n    {\n      id: guid(),\n      isCorner: true,\n      placement: \"top\",\n      ring: \"outer\",\n      type: \"tragedy\"\n    },\n    ...Array.from<Tile, Partial<Tile>>(Array(9), (_, idx) => ({\n      id: guid(),\n      isCorner: false,\n      placement: \"top\",\n      ring: \"outer\",\n      type: \"stone\",\n    })),\n    {\n      id: guid(),\n      isCorner: true,\n      placement: \"top\",\n      ring: \"outer\",\n      type: \"sacred_grounds\"\n    },\n    ...Array.from<Tile, Partial<Tile>>(Array(9), () => ({\n      id: guid(),\n      isCorner: false,\n      placement: \"right\",\n      ring: \"outer\",\n      type: \"gold\",\n    })),\n    {\n      id: guid(),\n      isCorner: true,\n      placement: \"bottom\",\n      ring: \"inner\",\n      type: \"fire_fountain\",\n    },\n    ...Array.from<Tile, Partial<Tile>>(Array(6), (_, idx) => ({\n      id: guid(),\n      isCorner: false,\n      placement: \"bottom\",\n      ring: \"inner\",\n      type: \"iron\",\n    })),\n    {\n      id: guid(),\n      isCorner: false,\n      placement: \"bottom\",\n      ring: \"inner\",\n      type: \"construction-site\",\n    },\n    {\n      id: guid(),\n      isCorner: true,\n      placement: \"bottom\",\n      ring: \"inner\",\n      type: \"construction-site\",\n    },\n    {\n      id: guid(),\n      isCorner: false,\n      placement: \"left\",\n      ring: \"inner\",\n      type: \"construction-site\",\n    },\n    ...Array.from<Tile, Partial<Tile>>(Array(6), (_, idx) => ({\n      id: guid(),\n      isCorner: false,\n      placement: \"left\",\n      ring: \"inner\",\n      type: idx === 3 ? \"sacred_grounds\" : \"mana\",\n    })),\n    {\n      id: guid(),\n      isCorner: true,\n      placement: \"top\",\n      ring: \"inner\",\n      type: \"fire_fountain\",\n    },\n    ...Array.from<Tile, Partial<Tile>>(Array(7), (_, idx) => ({\n      id: guid(),\n      isCorner: false,\n      placement: \"top\",\n      ring: \"inner\",\n      type: idx === 4 ? \"sacred_grounds\" : \"coal\",\n    })),\n    {\n      id: guid(),\n      isCorner: true,\n      placement: \"top\",\n      ring: \"inner\",\n      type: \"tragedy\"\n    },\n    ...Array.from<Tile, Partial<Tile>>(Array(7), (_, idx) => ({\n      id: guid(),\n      isCorner: false,\n      placement: \"right\",\n      ring: \"inner\",\n      type: idx === 6 ? \"rally_point\" : \"blood\",\n    })),\n  ]\n} as State;\n","<template>\n  <ux-dialog>\n    <ux-dialog-body>\n      <compose class=\"${bemclasses}\" view.bind=\"dialogView\"></compose>\n    </ux-dialog-body>\n  </ux-dialog>\n</template>\n","import { DialogService } from \"aurelia-dialog\";\nimport { Container } from \"aurelia-framework\";\nimport { kebabCase } from \"lodash\";\n\nexport interface DialogModel {\n  [key: string]: any;\n  /**\n   * the view url (relative to src/)\n   */\n  view: string;\n  /**\n   * any BEM classes to attach\n   */\n  bem?: string;\n}\n\nexport function openDialog(viewModel: any, model: DialogModel, keyboard: boolean | \"Escape\" | \"Enter\" = false) {\n  const dialogService = Container.instance.get(DialogService);\n  model.bem = model.bem || kebabCase(viewModel.name);\n\n  return dialogService.open({\n    centerHorizontalOnly: true,\n    keyboard,\n    model,\n    view: \"utils/generic-dialog.html\",\n    viewModel,\n  });\n}\n"]}